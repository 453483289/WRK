<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Windows Research Kernel v1.2: C:/Windows Research Kernel/inc/sertlp.h Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Windows Research Kernel v1.2
   </div>
   <div id="projectbrief">Have fun :)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('db/d2d/a02286_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">sertlp.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../db/d2d/a02286.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Copyright (c) Microsoft Corporation. All rights reserved.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">You may only use this code if you agree to the terms of the Windows Research Kernel Source Code License agreement (see License.txt).</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">If you do not agree to the terms, do not use the code.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">Module Name:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    sertlp.h</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">Abstract:</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    Include file for NT runtime routines that are callable by both</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    kernel mode code in the executive and user mode code in various</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">    NT subsystems, but which are private interfaces.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">    The routines in this file should not be used outside of the security</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">    related rtl files.</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifndef _SERTLP_</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#define _SERTLP_</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d59/a02219.html">nt.h</a>&quot;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d2/dd9/a02314.html">zwapi.h</a>&quot;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/dc3/a02256.html">ntrtl.h</a>&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//                                                                           //</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//    Local Macros                                                           //</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//                                                                           //</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#ifndef LongAlign</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a3b3dbc18944114b4076ce4d0c3dcfdef">   40</a></span>&#160;<span class="preprocessor">#define LongAlign LongAlignPtr</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a1f64aadb1a860ac51415fb9b32b312ee">   43</a></span>&#160;<span class="preprocessor">#define LongAlignPtr(Ptr) ((PVOID)(((ULONG_PTR)(Ptr) + 3) &amp; -4))</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a1c9d14bdc1c9ada63f83e93e328be84b">   44</a></span>&#160;<span class="preprocessor">#define LongAlignSize(Size) (((ULONG)(Size) + 3) &amp; -4)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">// Macros for calculating the address of the components of a security</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">// descriptor.  This will calculate the address of the field regardless</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">// of whether the security descriptor is absolute or self-relative form.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">// A null value indicates the specified field is not present in the</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">// security descriptor.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">//  NOTE: Similar copies of these macros appear in sep.h.</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//  Be sure to propagate bug fixes and changes.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a68f9703a2b7229281827e1d5bc9a530a">   59</a></span>&#160;<span class="preprocessor">#define RtlpOwnerAddrSecurityDescriptor( SD )                                  \</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">           (  ((SD)-&gt;Control &amp; SE_SELF_RELATIVE) ?                             \</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">               (   (((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Owner == 0) ? ((PSID) NULL) :               \</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">                       (PSID)RtlOffsetToPointer((SD), ((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Owner)    \</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">               ) :                                                             \</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">               (PSID)((SD)-&gt;Owner)                                             \</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">           )</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a1ae5ed7f5a2f3d50dc653c7d1e9de539">   67</a></span>&#160;<span class="preprocessor">#define RtlpGroupAddrSecurityDescriptor( SD )                                  \</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">           (  ((SD)-&gt;Control &amp; SE_SELF_RELATIVE) ?                             \</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">               (   (((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Group == 0) ? ((PSID) NULL) :               \</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">                       (PSID)RtlOffsetToPointer((SD), ((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Group)    \</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">               ) :                                                             \</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">               (PSID)((SD)-&gt;Group)                                             \</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">           )</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#ab3a29f850b47635960753778305a0f82">   75</a></span>&#160;<span class="preprocessor">#define RtlpSaclAddrSecurityDescriptor( SD )                                   \</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">           ( (!((SD)-&gt;Control &amp; SE_SACL_PRESENT) ) ?                           \</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">             (PACL)NULL :                                                      \</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="preprocessor">               (  ((SD)-&gt;Control &amp; SE_SELF_RELATIVE) ?                         \</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">                   (   (((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Sacl == 0) ? ((PACL) NULL) :            \</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor">                           (PACL)RtlOffsetToPointer((SD), ((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Sacl) \</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">                   ) :                                                         \</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="preprocessor">                   (PACL)((SD)-&gt;Sacl)                                          \</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="preprocessor">               )                                                               \</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="preprocessor">           )</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a52b78c0ccc1a141bb2f0912ae90fb1be">   86</a></span>&#160;<span class="preprocessor">#define RtlpDaclAddrSecurityDescriptor( SD )                                   \</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="preprocessor">           ( (!((SD)-&gt;Control &amp; SE_DACL_PRESENT) ) ?                           \</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">             (PACL)NULL :                                                      \</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">               (  ((SD)-&gt;Control &amp; SE_SELF_RELATIVE) ?                         \</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor">                   (   (((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Dacl == 0) ? ((PACL) NULL) :            \</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="preprocessor">                           (PACL)RtlOffsetToPointer((SD), ((SECURITY_DESCRIPTOR_RELATIVE *) (SD))-&gt;Dacl) \</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="preprocessor">                   ) :                                                         \</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="preprocessor">                   (PACL)((SD)-&gt;Dacl)                                          \</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="preprocessor">               )                                                               \</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="preprocessor">           )</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">//  Macro to determine if the given ID has the owner attribute set,</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">//  which means that it may be assignable as an owner</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//  The GroupSid should not be marked for UseForDenyOnly.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a7c77575dc69864f3396d347a0ce6e3bd">  106</a></span>&#160;<span class="preprocessor">#define RtlpIdAssignableAsOwner( G )                                               \</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">            ( (((G).Attributes &amp; SE_GROUP_OWNER) != 0)  &amp;&amp;                         \</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">              (((G).Attributes &amp; SE_GROUP_USE_FOR_DENY_ONLY) == 0) )</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">//  Macro to copy the state of the passed bits from the old security</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//  descriptor (OldSD) into the Control field of the new one (NewSD)</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#ac4869f77a683277682d7629dbc3d6198">  115</a></span>&#160;<span class="preprocessor">#define RtlpPropagateControlBits( NewSD, OldSD, Bits )                             \</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">            ( NewSD )-&gt;Control |=                     \</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">            (                                                                  \</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">            ( OldSD )-&gt;Control &amp; ( Bits )             \</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">            )</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">//  Macro to query whether or not the passed set of bits are ALL on</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">//  or not (ie, returns FALSE if some are on and not others)</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a60936e4951b5254ffb43baca1c1a8fb5">  127</a></span>&#160;<span class="preprocessor">#define RtlpAreControlBitsSet( SD, Bits )                                          \</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">            (BOOLEAN)                                                          \</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">            (                                                                  \</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="preprocessor">            (( SD )-&gt;Control &amp; ( Bits )) == ( Bits )  \</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="preprocessor">            )</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">//  Macro to set the passed control bits in the given Security Descriptor</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;</div>
<div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a16277294a616a48692ab4f2913fa1834">  137</a></span>&#160;<span class="preprocessor">#define RtlpSetControlBits( SD, Bits )                                             \</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">            (                                                                  \</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">            ( SD )-&gt;Control |= ( Bits )                                        \</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">            )</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">//  Macro to clear the passed control bits in the given Security Descriptor</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#aef17bc35a1ea878f4bedb94fabbee157">  146</a></span>&#160;<span class="preprocessor">#define RtlpClearControlBits( SD, Bits )                                           \</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">            (                                                                  \</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">            ( SD )-&gt;Control &amp;= ~( Bits )                                       \</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">            )</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">//                                                                            //</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">//                      Prototypes for local procedures                       //</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">//                                                                            //</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a10db7a3bc58f8a35eb9ff53e9bba9c65">RtlpContainsCreatorOwnerSid</a>(</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="../../d8/d7d/a00789.html">PKNOWN_ACE</a> Ace</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    );</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<a class="code" href="../../db/d2d/a02286.html#ac02a71c420d68074b600eeedd8422e19">RtlpContainsCreatorGroupSid</a>(</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <a class="code" href="../../d8/d7d/a00789.html">PKNOWN_ACE</a> Ace</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    );</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a5fecd27bb15029d767a1c093cc2fd00c">RtlpApplyAclToObject</a> (</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Acl,</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    );</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<a class="code" href="../../db/d2d/a02286.html#ab480a0f5efb65a4d69b939013a83008b">RtlpInheritAcl</a> (</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> DirectoryAcl,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> ChildAcl,</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> ChildGenericControl,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> AutoInherit,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> DefaultDescriptorForObject,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> OwnerSid,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> GroupSid,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ServerOwnerSid <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ServerGroupSid OPTIONAL,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsSacl,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../db/d44/a00533.html">GUID</a> **pNewObjectType OPTIONAL,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> GuidCount,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> *NewAcl,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../dd/d67/a02230.html#a5fb149be049e9964b63bdd041c1bb130">PBOOLEAN</a> NewAclExplicitlyAssigned,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> NewGenericControl</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    );</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a476e364854372f3a3cdd6f9721bc523a">RtlpInitializeAllowedAce</a>(</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d7/d46/a00002.html">PACCESS_ALLOWED_ACE</a> AllowedAce,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a> AceSize,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> InheritFlags,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> AceFlags,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#aa02fa07acf110491c9561459d8e3c4fa">ACCESS_MASK</a> Mask,</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> AllowedSid</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    );</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a109699528f071019c0f35f30c34f3be3">RtlpInitializeDeniedAce</a>(</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../de/d21/a00006.html">PACCESS_DENIED_ACE</a> DeniedAce,</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a> AceSize,</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> InheritFlags,</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> AceFlags,</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#aa02fa07acf110491c9561459d8e3c4fa">ACCESS_MASK</a> Mask,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> DeniedSid</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    );</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a994aa8f085598b0ee82c9d142fd22ca1">RtlpInitializeAuditAce</a> (</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d7/d46/a00002.html">PACCESS_ALLOWED_ACE</a> AuditAce,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a> AceSize,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> InheritFlags,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> AceFlags,</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#aa02fa07acf110491c9561459d8e3c4fa">ACCESS_MASK</a> Mask,</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a>  <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> AuditSid</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    );</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a03fb02069692f0aa7bcc0ac720b56e07">RtlpValidOwnerSubjectContext</a> (</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> Token,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> Owner,</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> ServerObject,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../dd/d67/a02230.html#ad64a44524a71caf12eab151d0daef5b2">PNTSTATUS</a> ReturnStatus</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    );</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a72c209612debcfa46791b63f69bc74b1">RtlpQuerySecurityDescriptor</a> (</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a> SecurityDescriptor,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a7dec33add44f7afd0eb61b1249a35298">__deref_out</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> *Owner,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> OwnerSize,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a7dec33add44f7afd0eb61b1249a35298">__deref_out</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> *PrimaryGroup,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> PrimaryGroupSize,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a7dec33add44f7afd0eb61b1249a35298">__deref_out</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> *Dacl,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> DaclSize,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a7dec33add44f7afd0eb61b1249a35298">__deref_out</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> *Sacl,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> SaclSize</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    );</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a1eb46143d17a0681a90e2addca5bb760">RtlpFreeVM</a>(</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#ab27e8a5903617bec9d037e4039ac00a7">PVOID</a> *Base</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    );</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a8a2144d239d6afa124e5ec59e2eb9e19">RtlpConvertToAutoInheritSecurityObject</a>(</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ParentDescriptor <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> CurrentSecurityDescriptor,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> *NewSecurityDescriptor,</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../db/d44/a00533.html">GUID</a> *ObjectType OPTIONAL,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    );</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<a class="code" href="../../db/d2d/a02286.html#a6ee5ac6666d1a87f20ff1e63cdc124f9">RtlpNewSecurityObject</a> (</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ParentDescriptor <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> CreatorDescriptor OPTIONAL,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> * NewDescriptor,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../db/d44/a00533.html">GUID</a> **pObjectType OPTIONAL,</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> GuidCOunt,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> AutoInheritFlags,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> Token OPTIONAL,</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    );</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<a class="code" href="../../db/d2d/a02286.html#ad2ade6a49301fb4ec6e67d9ed18d2012">RtlpSetSecurityObject</a> (</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#ab27e8a5903617bec9d037e4039ac00a7">PVOID</a> Object <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a923cbf88fdb4b0381d8e3c837656c0b2">SECURITY_INFORMATION</a> SecurityInformation,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ModificationDescriptor,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> *ObjectsSecurityDescriptor,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> AutoInheritFlags,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> PoolType,</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a> Token OPTIONAL</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    );</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a724fb9f82013c782db5c3c12ea36aac8">FORCEINLINE</a> </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a></div>
<div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="../../db/d2d/a02286.html#a80786fbc3ae2fb6380d05a2758ceab4f">  294</a></span>&#160;<a class="code" href="../../db/d2d/a02286.html#a80786fbc3ae2fb6380d05a2758ceab4f">RtlpSubAuthoritySid</a>(</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> Sid,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> SubAuthority</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    )</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    This function returns the address of a sub-authority array element of</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">    an SID.</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">    Sid - Pointer to the SID data structure.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    SubAuthority - An index indicating which sub-authority is being specified.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">        This value is not compared against the number of sub-authorities in the</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">        SID for validity.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="../../de/df9/a01624.html">PISID</a> ISid;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">//  Typecast to the opaque SID</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    ISid = (<a class="code" href="../../d3/d3a/a02259.html#ad30a32f32e06e7bb16b53e0a443eb289">PISID</a>)Sid;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keywordflow">return</span> &amp;(ISid-&gt;<a class="code" href="../../de/df9/a01624.html#a016791c144978a3390935063f68f1d6b">SubAuthority</a>[SubAuthority]);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;}</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#endif  // _SERTLP_</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="ttc" id="a02230_html_ac2bbd6d630a06a980d9a92ddb9a49928"><div class="ttname"><a href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a></div><div class="ttdeci">#define IN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00031">ntdef.h:31</a></div></div>
<div class="ttc" id="a02259_html_a5bdc6aa90cb7276fc7e2523b65e3556e"><div class="ttname"><a href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a></div><div class="ttdeci">PVOID PSECURITY_DESCRIPTOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00059">ntseapi.h:59</a></div></div>
<div class="ttc" id="a02259_html_aa02fa07acf110491c9561459d8e3c4fa"><div class="ttname"><a href="../../d3/d3a/a02259.html#aa02fa07acf110491c9561459d8e3c4fa">ACCESS_MASK</a></div><div class="ttdeci">ULONG ACCESS_MASK</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00111">ntseapi.h:111</a></div></div>
<div class="ttc" id="a02286_html_a476e364854372f3a3cdd6f9721bc523a"><div class="ttname"><a href="../../db/d2d/a02286.html#a476e364854372f3a3cdd6f9721bc523a">RtlpInitializeAllowedAce</a></div><div class="ttdeci">NTSTATUS RtlpInitializeAllowedAce(IN PACCESS_ALLOWED_ACE AllowedAce, IN USHORT AceSize, IN UCHAR InheritFlags, IN UCHAR AceFlags, IN ACCESS_MASK Mask, IN PSID AllowedSid)</div></div>
<div class="ttc" id="a02230_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01073">ntdef.h:1073</a></div></div>
<div class="ttc" id="a01624_html_a016791c144978a3390935063f68f1d6b"><div class="ttname"><a href="../../de/df9/a01624.html#a016791c144978a3390935063f68f1d6b">_SID::SubAuthority</a></div><div class="ttdeci">ULONG SubAuthority[ANYSIZE_ARRAY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00258">ntseapi.h:258</a></div></div>
<div class="ttc" id="a01585_html"><div class="ttname"><a href="../../da/de2/a01585.html">_SECURITY_DESCRIPTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01173">ntseapi.h:1173</a></div></div>
<div class="ttc" id="a02286_html_a6ee5ac6666d1a87f20ff1e63cdc124f9"><div class="ttname"><a href="../../db/d2d/a02286.html#a6ee5ac6666d1a87f20ff1e63cdc124f9">RtlpNewSecurityObject</a></div><div class="ttdeci">NTSTATUS RtlpNewSecurityObject(IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL, IN PSECURITY_DESCRIPTOR CreatorDescriptor OPTIONAL, OUT PSECURITY_DESCRIPTOR *NewDescriptor, IN GUID **pObjectType OPTIONAL, IN ULONG GuidCOunt, IN BOOLEAN IsDirectoryObject, IN ULONG AutoInheritFlags, IN HANDLE Token OPTIONAL, IN PGENERIC_MAPPING GenericMapping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l08275">sertl.c:8275</a></div></div>
<div class="ttc" id="a02230_html_a253b627decfeb8fee3765eba6d720d74"><div class="ttname"><a href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a></div><div class="ttdeci">ULONG * PULONG</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00401">ntdef.h:401</a></div></div>
<div class="ttc" id="a02286_html_ac02a71c420d68074b600eeedd8422e19"><div class="ttname"><a href="../../db/d2d/a02286.html#ac02a71c420d68074b600eeedd8422e19">RtlpContainsCreatorGroupSid</a></div><div class="ttdeci">BOOLEAN RtlpContainsCreatorGroupSid(PKNOWN_ACE Ace)</div></div>
<div class="ttc" id="a02219_html"><div class="ttname"><a href="../../de/d59/a02219.html">nt.h</a></div></div>
<div class="ttc" id="a01624_html"><div class="ttname"><a href="../../de/df9/a01624.html">_SID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00251">ntseapi.h:251</a></div></div>
<div class="ttc" id="a02230_html_a7f319bfc2492a2136964194204e7a8cf"><div class="ttname"><a href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div><div class="ttdeci">#define VOID</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00288">ntdef.h:288</a></div></div>
<div class="ttc" id="a02230_html_a5fb149be049e9964b63bdd041c1bb130"><div class="ttname"><a href="../../dd/d67/a02230.html#a5fb149be049e9964b63bdd041c1bb130">PBOOLEAN</a></div><div class="ttdeci">BOOLEAN * PBOOLEAN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01074">ntdef.h:1074</a></div></div>
<div class="ttc" id="a02256_html"><div class="ttname"><a href="../../de/dc3/a02256.html">ntrtl.h</a></div></div>
<div class="ttc" id="a02286_html_a80786fbc3ae2fb6380d05a2758ceab4f"><div class="ttname"><a href="../../db/d2d/a02286.html#a80786fbc3ae2fb6380d05a2758ceab4f">RtlpSubAuthoritySid</a></div><div class="ttdeci">FORCEINLINE PULONG RtlpSubAuthoritySid(IN PSID Sid, IN ULONG SubAuthority)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00294">sertlp.h:294</a></div></div>
<div class="ttc" id="a00521_html"><div class="ttname"><a href="../../d7/def/a00521.html">_GENERIC_MAPPING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00174">ntseapi.h:174</a></div></div>
<div class="ttc" id="a02230_html_aa8c0374618b33785ccb02f74bcfebc46"><div class="ttname"><a href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a></div><div class="ttdeci">void * HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00424">ntdef.h:424</a></div></div>
<div class="ttc" id="a00006_html"><div class="ttname"><a href="../../de/d21/a00006.html">_ACCESS_DENIED_ACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00809">ntseapi.h:809</a></div></div>
<div class="ttc" id="a02230_html_a724fb9f82013c782db5c3c12ea36aac8"><div class="ttname"><a href="../../dd/d67/a02230.html#a724fb9f82013c782db5c3c12ea36aac8">FORCEINLINE</a></div><div class="ttdeci">#define FORCEINLINE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00212">ntdef.h:212</a></div></div>
<div class="ttc" id="a02259_html_a783c8ad3877adc922b1184d3bfd83189"><div class="ttname"><a href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a></div><div class="ttdeci">PVOID PSID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00065">ntseapi.h:65</a></div></div>
<div class="ttc" id="a02286_html_ad2ade6a49301fb4ec6e67d9ed18d2012"><div class="ttname"><a href="../../db/d2d/a02286.html#ad2ade6a49301fb4ec6e67d9ed18d2012">RtlpSetSecurityObject</a></div><div class="ttdeci">NTSTATUS RtlpSetSecurityObject(IN PVOID Object OPTIONAL, IN SECURITY_INFORMATION SecurityInformation, IN PSECURITY_DESCRIPTOR ModificationDescriptor, IN OUT PSECURITY_DESCRIPTOR *ObjectsSecurityDescriptor, IN ULONG AutoInheritFlags, IN ULONG PoolType, IN PGENERIC_MAPPING GenericMapping, IN HANDLE Token OPTIONAL)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l09280">sertl.c:9280</a></div></div>
<div class="ttc" id="a02286_html_a03fb02069692f0aa7bcc0ac720b56e07"><div class="ttname"><a href="../../db/d2d/a02286.html#a03fb02069692f0aa7bcc0ac720b56e07">RtlpValidOwnerSubjectContext</a></div><div class="ttdeci">BOOLEAN RtlpValidOwnerSubjectContext(IN HANDLE Token, IN PSID Owner, IN BOOLEAN ServerObject, OUT PNTSTATUS ReturnStatus)</div></div>
<div class="ttc" id="a02286_html_a109699528f071019c0f35f30c34f3be3"><div class="ttname"><a href="../../db/d2d/a02286.html#a109699528f071019c0f35f30c34f3be3">RtlpInitializeDeniedAce</a></div><div class="ttdeci">NTSTATUS RtlpInitializeDeniedAce(IN PACCESS_DENIED_ACE DeniedAce, IN USHORT AceSize, IN UCHAR InheritFlags, IN UCHAR AceFlags, IN ACCESS_MASK Mask, IN PSID DeniedSid)</div></div>
<div class="ttc" id="a02286_html_a8a2144d239d6afa124e5ec59e2eb9e19"><div class="ttname"><a href="../../db/d2d/a02286.html#a8a2144d239d6afa124e5ec59e2eb9e19">RtlpConvertToAutoInheritSecurityObject</a></div><div class="ttdeci">NTSTATUS RtlpConvertToAutoInheritSecurityObject(IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL, IN PSECURITY_DESCRIPTOR CurrentSecurityDescriptor, OUT PSECURITY_DESCRIPTOR *NewSecurityDescriptor, IN GUID *ObjectType OPTIONAL, IN BOOLEAN IsDirectoryObject, IN PGENERIC_MAPPING GenericMapping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l06077">sertl.c:6077</a></div></div>
<div class="ttc" id="a02314_html"><div class="ttname"><a href="../../d2/dd9/a02314.html">zwapi.h</a></div></div>
<div class="ttc" id="a02230_html_a4f4bb67531a9bf6f0b9c6ad76aeba587"><div class="ttname"><a href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a></div><div class="ttdeci">unsigned char UCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00390">ntdef.h:390</a></div></div>
<div class="ttc" id="a00013_html"><div class="ttname"><a href="../../d7/dd4/a00013.html">_ACL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00658">ntseapi.h:658</a></div></div>
<div class="ttc" id="a02230_html_a5850d5316caf7f4cedd742fdf8cd7c02"><div class="ttname"><a href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a></div><div class="ttdeci">unsigned short USHORT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00391">ntdef.h:391</a></div></div>
<div class="ttc" id="a02286_html_a994aa8f085598b0ee82c9d142fd22ca1"><div class="ttname"><a href="../../db/d2d/a02286.html#a994aa8f085598b0ee82c9d142fd22ca1">RtlpInitializeAuditAce</a></div><div class="ttdeci">NTSTATUS RtlpInitializeAuditAce(IN PACCESS_ALLOWED_ACE AuditAce, IN USHORT AceSize, IN UCHAR InheritFlags, IN UCHAR AceFlags, IN ACCESS_MASK Mask, IN PSID AuditSid)</div></div>
<div class="ttc" id="a02286_html_a5fecd27bb15029d767a1c093cc2fd00c"><div class="ttname"><a href="../../db/d2d/a02286.html#a5fecd27bb15029d767a1c093cc2fd00c">RtlpApplyAclToObject</a></div><div class="ttdeci">VOID RtlpApplyAclToObject(IN PACL Acl, IN PGENERIC_MAPPING GenericMapping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l03317">sertl.c:3317</a></div></div>
<div class="ttc" id="a02230_html_ad64a44524a71caf12eab151d0daef5b2"><div class="ttname"><a href="../../dd/d67/a02230.html#ad64a44524a71caf12eab151d0daef5b2">PNTSTATUS</a></div><div class="ttdeci">NTSTATUS * PNTSTATUS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00536">ntdef.h:536</a></div></div>
<div class="ttc" id="a02286_html_a10db7a3bc58f8a35eb9ff53e9bba9c65"><div class="ttname"><a href="../../db/d2d/a02286.html#a10db7a3bc58f8a35eb9ff53e9bba9c65">RtlpContainsCreatorOwnerSid</a></div><div class="ttdeci">BOOLEAN RtlpContainsCreatorOwnerSid(PKNOWN_ACE Ace)</div></div>
<div class="ttc" id="a00533_html"><div class="ttname"><a href="../../db/d44/a00533.html">_GUID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc3/a02190_source.html#l00025">guiddef.h:25</a></div></div>
<div class="ttc" id="a02230_html_ab27e8a5903617bec9d037e4039ac00a7"><div class="ttname"><a href="../../dd/d67/a02230.html#ab27e8a5903617bec9d037e4039ac00a7">PVOID</a></div><div class="ttdeci">void * PVOID</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00245">ntdef.h:245</a></div></div>
<div class="ttc" id="a02259_html_a923cbf88fdb4b0381d8e3c837656c0b2"><div class="ttname"><a href="../../d3/d3a/a02259.html#a923cbf88fdb4b0381d8e3c837656c0b2">SECURITY_INFORMATION</a></div><div class="ttdeci">ULONG SECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01771">ntseapi.h:1771</a></div></div>
<div class="ttc" id="a00789_html"><div class="ttname"><a href="../../d8/d7d/a00789.html">_KNOWN_ACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d4d/a02285_source.html#l00037">seopaque.h:37</a></div></div>
<div class="ttc" id="a02289_html_a7dec33add44f7afd0eb61b1249a35298"><div class="ttname"><a href="../../de/d4e/a02289.html#a7dec33add44f7afd0eb61b1249a35298">__deref_out</a></div><div class="ttdeci">#define __deref_out</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00540">specstrings.h:540</a></div></div>
<div class="ttc" id="a02289_html_a3f6b8655e1aa9dfc15a9029f0343009e"><div class="ttname"><a href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a></div><div class="ttdeci">#define __in</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00497">specstrings.h:497</a></div></div>
<div class="ttc" id="a02230_html_a6a08ef8cc8945e56aaba56e0c8f194eb"><div class="ttname"><a href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div><div class="ttdeci">LONG NTSTATUS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00534">ntdef.h:534</a></div></div>
<div class="ttc" id="a02286_html_ab480a0f5efb65a4d69b939013a83008b"><div class="ttname"><a href="../../db/d2d/a02286.html#ab480a0f5efb65a4d69b939013a83008b">RtlpInheritAcl</a></div><div class="ttdeci">NTSTATUS RtlpInheritAcl(IN PACL DirectoryAcl, IN PACL ChildAcl, IN ULONG ChildGenericControl, IN BOOLEAN IsDirectoryObject, IN BOOLEAN AutoInherit, IN BOOLEAN DefaultDescriptorForObject, IN PSID OwnerSid, IN PSID GroupSid, IN PSID ServerOwnerSid OPTIONAL, IN PSID ServerGroupSid OPTIONAL, IN PGENERIC_MAPPING GenericMapping, IN BOOLEAN IsSacl, IN GUID **pNewObjectType OPTIONAL, IN ULONG GuidCount, OUT PACL *NewAcl, OUT PBOOLEAN NewAclExplicitlyAssigned, OUT PULONG NewGenericControl)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l04746">sertl.c:4746</a></div></div>
<div class="ttc" id="a02286_html_a72c209612debcfa46791b63f69bc74b1"><div class="ttname"><a href="../../db/d2d/a02286.html#a72c209612debcfa46791b63f69bc74b1">RtlpQuerySecurityDescriptor</a></div><div class="ttdeci">VOID RtlpQuerySecurityDescriptor(__in PISECURITY_DESCRIPTOR SecurityDescriptor, __deref_out PSID *Owner, __out PULONG OwnerSize, __deref_out PSID *PrimaryGroup, __out PULONG PrimaryGroupSize, __deref_out PACL *Dacl, __out PULONG DaclSize, __deref_out PACL *Sacl, __out PULONG SaclSize)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d69/a02661_source.html#l00385">rtlassig.c:385</a></div></div>
<div class="ttc" id="a02244_html_a78212918c5b09e3304c1d3c041ba3a1a"><div class="ttname"><a href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a></div><div class="ttdeci">IN PLSA_DISPATCH_TABLE IN PLSA_STRING Database OPTIONAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/a02244_source.html#l01130">ntlsa.h:1130</a></div></div>
<div class="ttc" id="a02289_html_abb4c3c1135aab6c47cff22e7c16efb74"><div class="ttname"><a href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a></div><div class="ttdeci">#define __out</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00500">specstrings.h:500</a></div></div>
<div class="ttc" id="a02230_html_aec78e7a9e90a406a56f859ee456e8eae"><div class="ttname"><a href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a></div><div class="ttdeci">#define OUT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00035">ntdef.h:35</a></div></div>
<div class="ttc" id="a02286_html_a1eb46143d17a0681a90e2addca5bb760"><div class="ttname"><a href="../../db/d2d/a02286.html#a1eb46143d17a0681a90e2addca5bb760">RtlpFreeVM</a></div><div class="ttdeci">NTSTATUS RtlpFreeVM(IN PVOID *Base)</div></div>
<div class="ttc" id="a00002_html"><div class="ttname"><a href="../../d7/d46/a00002.html">_ACCESS_ALLOWED_ACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00801">ntseapi.h:801</a></div></div>
<div class="ttc" id="a02230_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00392">ntdef.h:392</a></div></div>
<div class="ttc" id="a02259_html_ad30a32f32e06e7bb16b53e0a443eb289"><div class="ttname"><a href="../../d3/d3a/a02259.html#ad30a32f32e06e7bb16b53e0a443eb289">PISID</a></div><div class="ttdeci">struct _SID * PISID</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_f22a2235bfed9e7f28226e9ee4e6031c.html">Windows Research Kernel</a></li><li class="navelem"><a class="el" href="../../dir_be9d8b0f6c64f3bf5872587948458da6.html">inc</a></li><li class="navelem"><a class="el" href="../../db/d2d/a02286.html">sertlp.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>

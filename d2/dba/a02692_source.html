<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>Windows Research Kernel v1.2: C:/Windows Research Kernel/se/seassign.c Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Windows Research Kernel v1.2
   </div>
   <div id="projectbrief">Have fun :)</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('d2/dba/a02692_source.html','../../');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">seassign.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d2/dba/a02692.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">Copyright (c) Microsoft Corporation. All rights reserved. </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">You may only use this code if you agree to the terms of the Windows Research Kernel Source Code License agreement (see License.txt).</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">If you do not agree to the terms, do not use the code.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">Module Name:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">    Seassign.c</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">Abstract:</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">    This Module implements the SeAssignSecurity procedure.  For a description</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">    of the pool allocation strategy please see the comments in semethod.c</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/dd8/a02685.html">pch.h</a>&quot;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#pragma hdrstop</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//  Local macros and procedures</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<a class="code" href="../../d2/dba/a02692.html#a0c3ef3142d6465d6a70feddd163abc0d">SepInheritAcl</a> (</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Acl,</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> OwnerSid,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> GroupSid,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ServerSid <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ClientSid OPTIONAL,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d5/ddd/a02184.html#a971c37f796ee1dd6a449795d1b978bf4">POOL_TYPE</a> PoolType,</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> *NewAcl</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    );</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#ifdef ALLOC_PRAGMA</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SeAssignSecurity)</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SeAssignSecurityEx)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SeDeassignSecurity)</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepInheritAcl)</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SeAssignWorldSecurityDescriptor)</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepDumpSecurityDescriptor)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepPrintAcl)</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepPrintSid)</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepDumpTokenInfo)</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#pragma alloc_text(PAGE,SepSidTranslation)</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#endif //DBG</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">// These variables control whether security descriptors and token</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">// information are dumped by their dump routines.  This allows</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">// selective turning on and off of debugging output by both program</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">// control and via the kernel debugger.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SepDumpSD = <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> SepDumpToken = <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="../../d2/dba/a02692.html#a4862002b1da4aae1bec6c8d74a0dc106">   76</a></span>&#160;<a class="code" href="../../d2/dba/a02692.html#a4862002b1da4aae1bec6c8d74a0dc106">SeAssignSecurity</a> (</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ParentDescriptor,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ExplicitDescriptor,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> *NewDescriptor,</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../dc/d42/a01591.html">PSECURITY_SUBJECT_CONTEXT</a> SubjectContext,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../d5/ddd/a02184.html#a971c37f796ee1dd6a449795d1b978bf4">POOL_TYPE</a> PoolType</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    )</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">    This routine assumes privilege checking HAS NOT yet been performed</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">    and so will be performed by this routine.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">    This procedure is used to build a security descriptor for a new object</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">    given the security descriptor of its parent directory and any originally</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    requested security for the object.  The final security descriptor</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">    returned to the caller may contain a mix of information, some explicitly</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">    provided other from the new object&#39;s parent.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    See RtlpNewSecurityObject for a descriptor of how the NewDescriptor is</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">    built.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">    ParentDescriptor - Optionally supplies the security descriptor of the</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">        parent directory under which this new object is being created.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">    ExplicitDescriptor - Supplies the address of a pointer to the security</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">        descriptor as specified by the user that is to be applied to</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">        the new object.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">    NewDescriptor - Returns the actual security descriptor for the new</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">        object that has been modified according to above rules.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">    IsDirectoryObject - Specifies if the new object is itself a directory</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">        object.  A value of TRUE indicates the object is a container of other</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">        objects.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">    SubjectContext - Supplies the security context of the subject creating the</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">        object. This is used to retrieve default security information for the</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">        new object, such as default owner, primary group, and discretionary</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">        access control.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">    GenericMapping - Supplies a pointer to an array of access mask values</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">        denoting the mapping between each generic right to non-generic rights.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">    PoolType - Specifies the pool type to use to when allocating a new</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">        security descriptor.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">    STATUS_SUCCESS - indicates the operation was successful.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">    STATUS_INVALID_OWNER - The owner SID provided as the owner of the</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">        target security descriptor is not one the caller is authorized</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">        to assign as the owner of an object.</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    STATUS_PRIVILEGE_NOT_HELD - The caller does not have the privilege</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">        necessary to explicitly assign the specified system ACL.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">        SeSecurityPrivilege privilege is needed to explicitly assign</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">        system ACLs to objects.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> AutoInherit = 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( ExplicitDescriptor) ) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        SepDumpSecurityDescriptor( ExplicitDescriptor,</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                   <span class="stringliteral">&quot;\nSeAssignSecurity: Input security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                 );</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    }</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( ParentDescriptor )) {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        SepDumpSecurityDescriptor( ParentDescriptor,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                   <span class="stringliteral">&quot;\nSeAssignSecurity: Parent security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                 );</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#endif // DBG</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">// If the Parent SD was created via AutoInheritance,</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">//  and this object is being created with no explicit descriptor,</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">//  then we can safely create this object as AutoInherit.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">if</span> ( ParentDescriptor != <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">if</span> ( (ExplicitDescriptor == <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;              (((<a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a>)ExplicitDescriptor)-&gt;Control &amp; <a class="code" href="../../d3/d3a/a02259.html#af8a3094a4a40ef8d0e5eee5012e827d4">SE_DACL_PRESENT</a>) == 0 ) &amp;&amp;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;             (((<a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a>)ParentDescriptor)-&gt;Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a2c99dbbbae1f21757cf867d6ba243e30">SE_DACL_AUTO_INHERITED</a>) != 0 ) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            AutoInherit |= <a class="code" href="../../d7/d24/a02261.html#a59d287bcfe603ad0d4b5a330be02d22d">SEF_DACL_AUTO_INHERIT</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> ( (ExplicitDescriptor == <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ||</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;             (((<a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a>)ExplicitDescriptor)-&gt;Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a974c8776187280aecce79aa09411978a">SE_SACL_PRESENT</a>) == 0 ) &amp;&amp;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;             (((<a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a>)ParentDescriptor)-&gt;Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a72b025cb2be68de4fd11bdb82c21fd96">SE_SACL_AUTO_INHERITED</a>) != 0 ) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            AutoInherit |= <a class="code" href="../../d7/d24/a02261.html#ab31f4c0fab101f20d852eb7b68b57cd4">SEF_SACL_AUTO_INHERIT</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    Status = <a class="code" href="../../db/d2d/a02286.html#a6ee5ac6666d1a87f20ff1e63cdc124f9">RtlpNewSecurityObject</a> (</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    ParentDescriptor <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    ExplicitDescriptor OPTIONAL,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                    NewDescriptor,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,   <span class="comment">// No object type</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                    0,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    IsDirectoryObject,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    AutoInherit,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>) SubjectContext,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    GenericMapping );</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d67/a02230.html#ad14231612b7a675d33f0ead0b695d21a">NT_SUCCESS</a>(Status)) {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        SepDumpSecurityDescriptor( *NewDescriptor,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                   <span class="stringliteral">&quot;SeAssignSecurity: Final security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                 );</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// RtlpNewSecurityObject always uses PagedPool.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ab8caf1706fee9e06b2937fec2fb3d6ed">UNREFERENCED_PARAMETER</a>( PoolType );</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;}</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="../../d2/dba/a02692.html#a8049502f7317002f2e438e5821ee3997">  216</a></span>&#160;<a class="code" href="../../d2/dba/a02692.html#a8049502f7317002f2e438e5821ee3997">SeAssignSecurityEx</a> (</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ParentDescriptor,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> ExplicitDescriptor,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> *NewDescriptor,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a> <a class="code" href="../../db/d44/a00533.html">GUID</a> *ObjectType,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> AutoInheritFlags,</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../dc/d42/a01591.html">PSECURITY_SUBJECT_CONTEXT</a> SubjectContext,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../d5/ddd/a02184.html#a971c37f796ee1dd6a449795d1b978bf4">POOL_TYPE</a> PoolType</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    )</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">    This routine assumes privilege checking HAS NOT yet been performed</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">    and so will be performed by this routine.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">    This procedure is used to build a security descriptor for a new object</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">    given the security descriptor of its parent directory and any originally</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">    requested security for the object.  The final security descriptor</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">    returned to the caller may contain a mix of information, some explicitly</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">    provided other from the new object&#39;s parent.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">    See RtlpNewSecurityObject for a descriptor of how the NewDescriptor is</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">    built.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">    ParentDescriptor - Optionally supplies the security descriptor of the</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">        parent directory under which this new object is being created.</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">    ExplicitDescriptor - Supplies the address of a pointer to the security</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">        descriptor as specified by the user that is to be applied to</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">        the new object.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">    NewDescriptor - Returns the actual security descriptor for the new</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">        object that has been modified according to above rules.</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">    ObjectType - GUID of the object type being created.  If the object being</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">        created has no GUID associated with it, then this argument is</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">        specified as NULL.</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">    IsDirectoryObject - Specifies if the new object is itself a directory</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        object.  A value of TRUE indicates the object is a container of other</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">        objects.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">    AutoInheritFlags - Controls automatic inheritance of ACES from the Parent</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">        Descriptor.  Valid values are a bits mask of the logical OR of</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">        one or more of the following bits:</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">        SEF_DACL_AUTO_INHERIT - If set, inherit ACEs from the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">            DACL ParentDescriptor are inherited to NewDescriptor in addition</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">            to any explicit ACEs specified by the CreatorDescriptor.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">        SEF_SACL_AUTO_INHERIT - If set, inherit ACEs from the</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">            SACL ParentDescriptor are inherited to NewDescriptor in addition</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">            to any explicit ACEs specified by the CreatorDescriptor.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">        SEF_DEFAULT_DESCRIPTOR_FOR_OBJECT - If set, the CreatorDescriptor</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">            is the default descriptor for ObjectType.  As such, the</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">            CreatorDescriptor will be ignored if any ObjectType specific</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">            ACEs are inherited from the parent.  If no such ACEs are inherited,</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">            the CreatorDescriptor is handled as though this flag were not</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">            specified.</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">        SEF_AVOID_PRIVILEGE_CHECK - If set, no privilege checking is done by this</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">            routine.  This flag is useful while implementing automatic inheritance</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">            to avoid checking privileges on each child updated.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">    SubjectContext - Supplies the security context of the subject creating the</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">        object. This is used to retrieve default security information for the</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">        new object, such as default owner, primary group, and discretionary</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">        access control.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">    GenericMapping - Supplies a pointer to an array of access mask values</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">        denoting the mapping between each generic right to non-generic rights.</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    PoolType - Specifies the pool type to use to when allocating a new</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">        security descriptor.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">    STATUS_SUCCESS - indicates the operation was successful.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">    STATUS_INVALID_OWNER - The owner SID provided as the owner of the</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">        target security descriptor is not one the caller is authorized</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">        to assign as the owner of an object.</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    STATUS_PRIVILEGE_NOT_HELD - The caller does not have the privilege</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">        necessary to explicitly assign the specified system ACL.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">        SeSecurityPrivilege privilege is needed to explicitly assign</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">        system ACLs to objects.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( ExplicitDescriptor) ) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        SepDumpSecurityDescriptor( ExplicitDescriptor,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                   <span class="stringliteral">&quot;\nSeAssignSecurityEx: Input security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                                 );</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( ParentDescriptor )) {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        SepDumpSecurityDescriptor( ParentDescriptor,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                   <span class="stringliteral">&quot;\nSeAssignSecurityEx: Parent security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                 );</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="preprocessor">#endif // DBG</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    Status = <a class="code" href="../../db/d2d/a02286.html#a6ee5ac6666d1a87f20ff1e63cdc124f9">RtlpNewSecurityObject</a> (</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    ParentDescriptor <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    ExplicitDescriptor OPTIONAL,</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                    NewDescriptor,</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                    ObjectType ? &amp;ObjectType : <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    ObjectType ? 1 : 0,</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    IsDirectoryObject,</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    AutoInheritFlags,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a>) SubjectContext,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                    GenericMapping );</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">if</span> ( <a class="code" href="../../dd/d67/a02230.html#ad14231612b7a675d33f0ead0b695d21a">NT_SUCCESS</a>(Status)) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        SepDumpSecurityDescriptor( *NewDescriptor,</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                   <span class="stringliteral">&quot;SeAssignSecurityEx: Final security descriptor = \n&quot;</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                                 );</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">// RtlpNewSecurityObject always uses PagedPool.</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ab8caf1706fee9e06b2937fec2fb3d6ed">UNREFERENCED_PARAMETER</a>( PoolType );</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="../../d2/dba/a02692.html#ac4c6b8d37cddc1b71392bf478ce9c653">  362</a></span>&#160;<a class="code" href="../../d2/dba/a02692.html#ac4c6b8d37cddc1b71392bf478ce9c653">SeDeassignSecurity</a> (</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a274c77397b30c926ba3e01b7b72726fa">__deref_inout</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> *SecurityDescriptor</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    )</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">    This routine deallocates the memory associated with a security descriptor</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">    that was assigned using SeAssignSecurity.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">    SecurityDescriptor - Supplies the address of a pointer to the security</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">        descriptor  being deleted.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">    STATUS_SUCCESS - The deallocation was successful.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">if</span> ((*SecurityDescriptor) != <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <a class="code" href="../../d8/db2/a02125.html#ac4f0427f782e5bfd15644bc30afc1805">ExFreePool</a>( (*SecurityDescriptor) );</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">//  And zero out the pointer to it for safety sake</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    (*SecurityDescriptor) = <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">return</span>( <a class="code" href="../../dc/d18/a02260.html#ae56fdb340b23940f7a64ed2e37c1774a">STATUS_SUCCESS</a> );</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;}</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="../../d2/dba/a02692.html#a17ae56afe751f3dc66c1fa8eff67ed1e">  405</a></span>&#160;<a class="code" href="../../d2/dba/a02692.html#a0c3ef3142d6465d6a70feddd163abc0d">SepInheritAcl</a> (</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Acl,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> IsDirectoryObject,</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ClientOwnerSid,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ClientGroupSid,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ServerOwnerSid <a class="code" href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a>,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> ServerGroupSid OPTIONAL,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/def/a00521.html">PGENERIC_MAPPING</a> GenericMapping,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d5/ddd/a02184.html#a971c37f796ee1dd6a449795d1b978bf4">POOL_TYPE</a> PoolType,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> *NewAcl</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    )</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">    This is a private routine that produces an inherited acl from</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">    a parent acl according to the rules of inheritance</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">    Acl - Supplies the acl being inherited.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">    IsDirectoryObject - Specifies if the new acl is for a directory.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">    OwnerSid - Specifies the owner Sid to use.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">    GroupSid - Specifies the group SID to use.</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">    ServerSid - Specifies the Server SID to use.</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">    ClientSid - Specifies the Client SID to use.</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    GenericMapping - Specifies the generic mapping to use.</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">    PoolType - Specifies the pool type for the new acl.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">    NewAcl - Receives a pointer to the new (inherited) acl.</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">    STATUS_SUCCESS - An inheritable ACL was successfully generated.</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">    STATUS_NO_INHERITANCE - An inheritable ACL was not successfully generated.</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">        This is a warning completion status.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">    STATUS_BAD_INHERITANCE_ACL - Indicates the acl built was not a valid ACL.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">        This can be caused by a number of things.  One of the more probable</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">        causes is the replacement of a CreatorId with an SID that didn&#39;t fit</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">        into the ACE or ACL.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">    STATUS_UNKNOWN_REVISION - Indicates the source ACL is a revision that</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">        is unknown to this routine.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;{</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">//                                                                          //</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">//   The logic in the ACL inheritance code must mirror the code for         //</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">//   inheritance in the user mode runtime (in sertl.c). Do not make changes //</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">//   here without also making changes in that module.                       //</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">//                                                                          //</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> NewAclLength;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> NewAclExplicitlyAssigned;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> NewGenericControl;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#ab49350da23720546beb60b8054facd9c">ASSERT</a>( PoolType == <a class="code" href="../../d5/ddd/a02184.html#a32a1467b2542bf2a6384f6fc19953bddae0942a3b0a37bffc44d7b2d63e116ef1">PagedPool</a> ); <span class="comment">// RtlpInheritAcl assumes paged pool</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">//  First check if the acl is null</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">if</span> (Acl == <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../dc/d18/a02260.html#a1b28d9f0fc2ca4517f6c0606efb4e0f5">STATUS_NO_INHERITANCE</a>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    }</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// Generating an inheritable ACL.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="comment">// Pass all parameters as though there is no auto inheritance.</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    Status = <a class="code" href="../../db/d2d/a02286.html#ab480a0f5efb65a4d69b939013a83008b">RtlpInheritAcl</a>(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                 Acl,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                 <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,  <span class="comment">// No child ACL since no auto inheritance</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                 0,     <span class="comment">// No child control since no auto inheritance</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                 IsDirectoryObject,</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                 <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="comment">// Not AutoInherit since no auto inheritance</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                 <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="comment">// Not DefaultDescriptor since no auto inheritance</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                 ClientOwnerSid,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                 ClientGroupSid,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                 ServerOwnerSid,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                 ServerGroupSid,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                 GenericMapping,</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                 <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>, <span class="comment">// Isn&#39;t a SACL</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                 <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,  <span class="comment">// No object GUID</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                 0,</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                 NewAcl,</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                 &amp;NewAclExplicitlyAssigned,</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                 &amp;NewGenericControl );</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;}</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="../../d2/dba/a02692.html#a814c538ea35b1d0c22c7d7d7ca2bb46d">  519</a></span>&#160;<a class="code" href="../../d2/dba/a02692.html#a814c538ea35b1d0c22c7d7d7ca2bb46d">SeAssignWorldSecurityDescriptor</a>(</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a26417a011a3b2059a493df059768499e">__inout_bcount_part</a>( *<a class="code" href="../../d8/d51/a02244.html#a1eba21559f17793c695f34f7e4787604">Length</a>, *<a class="code" href="../../d8/d51/a02244.html#a1eba21559f17793c695f34f7e4787604">Length</a>) <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> SecurityDescriptor,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a9a66acb8f87800f41a837406c837cb32">__inout</a> <a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a> <a class="code" href="../../d8/d51/a02244.html#a1eba21559f17793c695f34f7e4787604">Length</a>,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <a class="code" href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a> <a class="code" href="../../d3/d3a/a02259.html#a4f4058db98443ea272a9017c4cd374f6">PSECURITY_INFORMATION</a> SecurityInformation</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    )</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">    This routine is called by the I/O system to properly initialize a</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">    security descriptor for a FAT file.  It will take a pointer to a</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">    buffer containing an emptry security descriptor, and create in the</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">    buffer a self-relative security descriptor with</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">        Owner = WorldSid,</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">        Group = WorldSid.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">    Thus, a FAT file is accessable to all.</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">    SecurityDescriptor - Supplies a pointer to a buffer in which will be</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">        created a self-relative security descriptor as described above.</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">    Length - The length in bytes of the buffer.  If the length is too</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">        small, it will contain the minimum size required upon exit.</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">    STATUS_BUFFER_TOO_SMALL - The buffer was not big enough to contain</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">        the requested information.</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6addcc52e2dfddf231bf3213859ae2bb">PCHAR</a> Field;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6addcc52e2dfddf231bf3213859ae2bb">PCHAR</a> Base;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> WorldSidLength;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="../../d6/d91/a01587.html">PISECURITY_DESCRIPTOR_RELATIVE</a> ISecurityDescriptor;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> MinSize;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a> <a class="code" href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a>;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keywordflow">if</span> ( !<a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( SecurityInformation )) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="../../dc/d18/a02260.html#a415c67a7a97e52ebee39db8c3addfd4d">STATUS_ACCESS_DENIED</a> );</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    }</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    WorldSidLength = <a class="code" href="../../d3/d81/a02284.html#a6b4016db9802d1ca4d0c566f618ff03e">SeLengthSid</a>( <a class="code" href="../../d3/d81/a02284.html#a643a68c1e88c00e3c4138c3fcf8e75ee">SeWorldSid</a> );</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    MinSize = <span class="keyword">sizeof</span>( <a class="code" href="../../d3/d3a/a02259.html#aecc9f2cb4b77c249451b1db76791af53">SECURITY_DESCRIPTOR_RELATIVE</a> ) + 2 * WorldSidLength;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">if</span> ( *Length &lt; MinSize ) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        *Length = MinSize;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keywordflow">return</span>( <a class="code" href="../../dc/d18/a02260.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a> );</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    *Length = MinSize;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    ISecurityDescriptor = (<a class="code" href="../../d6/d91/a01587.html">SECURITY_DESCRIPTOR_RELATIVE</a> *)SecurityDescriptor;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    Status = <a class="code" href="../../de/dc3/a02256.html#aec84fe2ac482efd50b064cfd45772cef">RtlCreateSecurityDescriptorRelative</a>( ISecurityDescriptor,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                                          <a class="code" href="../../d3/d3a/a02259.html#aa3ccd781d22af696976f185ecefa0f47">SECURITY_DESCRIPTOR_REVISION</a> );</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d67/a02230.html#ad14231612b7a675d33f0ead0b695d21a">NT_SUCCESS</a>( Status )) {</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">return</span>( Status );</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    Base = (<a class="code" href="../../dd/d67/a02230.html#a6addcc52e2dfddf231bf3213859ae2bb">PCHAR</a>)(ISecurityDescriptor);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    Field =  Base + <span class="keyword">sizeof</span>(<a class="code" href="../../d3/d3a/a02259.html#aecc9f2cb4b77c249451b1db76791af53">SECURITY_DESCRIPTOR_RELATIVE</a>);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">if</span> ( *SecurityInformation &amp; <a class="code" href="../../d3/d3a/a02259.html#a5befedca477346da731bee5367de1921">OWNER_SECURITY_INFORMATION</a> ) {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#ab329f640d89ba58a8e81e19004bdb7bd">RtlCopyMemory</a>( Field, <a class="code" href="../../d3/d81/a02284.html#a643a68c1e88c00e3c4138c3fcf8e75ee">SeWorldSid</a>, WorldSidLength );</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        ISecurityDescriptor-&gt;<a class="code" href="../../d6/d91/a01587.html#a5766dc6ae7409fedf88a0e7a263cb8ca">Owner</a> = <a class="code" href="../../de/dc3/a02256.html#a7dac7ee67fd8470847e01b44f980cae6">RtlPointerToOffset</a>(Base,Field);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        Field += WorldSidLength;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="keywordflow">if</span> ( *SecurityInformation &amp; <a class="code" href="../../d3/d3a/a02259.html#ab1cf9e99656615972a3407e5d72574b5">GROUP_SECURITY_INFORMATION</a> ) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#ab329f640d89ba58a8e81e19004bdb7bd">RtlCopyMemory</a>( Field, <a class="code" href="../../d3/d81/a02284.html#a643a68c1e88c00e3c4138c3fcf8e75ee">SeWorldSid</a>, WorldSidLength );</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        ISecurityDescriptor-&gt;<a class="code" href="../../d6/d91/a01587.html#aa24ad3c48067e3f489f174c08beebdb4">Group</a> = <a class="code" href="../../de/dc3/a02256.html#a7dac7ee67fd8470847e01b44f980cae6">RtlPointerToOffset</a>(Base,Field);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">if</span> ( *SecurityInformation &amp; <a class="code" href="../../d3/d3a/a02259.html#a209f30ceb819d151d3e4479960b65fef">DACL_SECURITY_INFORMATION</a> ) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <a class="code" href="../../db/d2d/a02286.html#a16277294a616a48692ab4f2913fa1834">RtlpSetControlBits</a>( ISecurityDescriptor, <a class="code" href="../../d3/d3a/a02259.html#af8a3094a4a40ef8d0e5eee5012e827d4">SE_DACL_PRESENT</a> );</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> ( *SecurityInformation &amp; <a class="code" href="../../d3/d3a/a02259.html#ad7d3e853b74bd0e483fa2c6107fb69fd">SACL_SECURITY_INFORMATION</a> ) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <a class="code" href="../../db/d2d/a02286.html#a16277294a616a48692ab4f2913fa1834">RtlpSetControlBits</a>( ISecurityDescriptor, <a class="code" href="../../d3/d3a/a02259.html#a974c8776187280aecce79aa09411978a">SE_SACL_PRESENT</a> );</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <a class="code" href="../../db/d2d/a02286.html#a16277294a616a48692ab4f2913fa1834">RtlpSetControlBits</a>( ISecurityDescriptor, <a class="code" href="../../d3/d3a/a02259.html#a6243776f2306b552ea5cccf5b9873cef">SE_SELF_RELATIVE</a> );</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">return</span>( <a class="code" href="../../dc/d18/a02260.html#ae56fdb340b23940f7a64ed2e37c1774a">STATUS_SUCCESS</a> );</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;}</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="preprocessor">#if DBG</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;SepDumpSecurityDescriptor(</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a> SecurityDescriptor,</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../dd/d67/a02230.html#adced8a140f55db5bbb1e36a4bd987926">PSZ</a> TitleString</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    )</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment">    Private routine to dump a security descriptor to the debug</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">    screen.</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="comment">    SecurityDescriptor - Supplies the security descriptor to be dumped.</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment">    TitleString - A null terminated string to print before dumping</span></div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment">        the security descriptor.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="comment">    None.</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;{</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="../../da/de2/a01585.html">PISECURITY_DESCRIPTOR</a> ISecurityDescriptor;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> Revision;</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <a class="code" href="../../d3/d3a/a02259.html#a5dcdcb687d0ee6009b792fe98286b02f">SECURITY_DESCRIPTOR_CONTROL</a> Control;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> Owner;</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> <a class="code" href="../../df/def/a02369.html#ac72f24fb0e57feffb445dd9456b8597a">Group</a>;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Sacl;</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Dacl;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <span class="keywordflow">if</span> (!SepDumpSD) {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a>( SecurityDescriptor )) {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    }</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(TitleString);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    ISecurityDescriptor = ( <a class="code" href="../../d3/d3a/a02259.html#a61cf327633d2a19c13477bda23e517ad">PISECURITY_DESCRIPTOR</a> )SecurityDescriptor;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    Revision = ISecurityDescriptor-&gt;<a class="code" href="../../da/de2/a01585.html#a04d07191f19edda54e63353837a588a7">Revision</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    Control  = ISecurityDescriptor-&gt;<a class="code" href="../../da/de2/a01585.html#aedf674c652a73f50f9a896b2497f1409">Control</a>;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;    Owner    = <a class="code" href="../../db/d2d/a02286.html#a68f9703a2b7229281827e1d5bc9a530a">RtlpOwnerAddrSecurityDescriptor</a>( ISecurityDescriptor );</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    Group    = <a class="code" href="../../db/d2d/a02286.html#a1ae5ed7f5a2f3d50dc653c7d1e9de539">RtlpGroupAddrSecurityDescriptor</a>( ISecurityDescriptor );</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    Sacl     = <a class="code" href="../../db/d2d/a02286.html#ab3a29f850b47635960753778305a0f82">RtlpSaclAddrSecurityDescriptor</a>( ISecurityDescriptor );</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    Dacl     = <a class="code" href="../../db/d2d/a02286.html#a52b78c0ccc1a141bb2f0912ae90fb1be">RtlpDaclAddrSecurityDescriptor</a>( ISecurityDescriptor );</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\nSECURITY DESCRIPTOR\n&quot;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Revision = %d\n&quot;</span>,Revision);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="comment">// Print control info</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a0d38ac1ff4d6cc3b7f3b7bb1243db7c7">SE_OWNER_DEFAULTED</a>) {</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Owner defaulted\n&quot;</span>);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#abfbebcb07a24f698a6c04b3bc0ad32f4">SE_GROUP_DEFAULTED</a>) {</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Group defaulted\n&quot;</span>);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#af8a3094a4a40ef8d0e5eee5012e827d4">SE_DACL_PRESENT</a>) {</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Dacl present\n&quot;</span>);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a23a254f5381c9262ec2c236a0e1f62f1">SE_DACL_DEFAULTED</a>) {</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Dacl defaulted\n&quot;</span>);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a974c8776187280aecce79aa09411978a">SE_SACL_PRESENT</a>) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Sacl present\n&quot;</span>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a6a17154ddd8ee109a4deeb874f14264e">SE_SACL_DEFAULTED</a>) {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Sacl defaulted\n&quot;</span>);</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    }</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a6243776f2306b552ea5cccf5b9873cef">SE_SELF_RELATIVE</a>) {</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Self relative\n&quot;</span>);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a8d0e3871ec8a12b6bcda7c0858ba64be">SE_DACL_UNTRUSTED</a>) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Dacl untrusted\n&quot;</span>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    }</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (Control &amp; <a class="code" href="../../d3/d3a/a02259.html#a39e75889cffac1a2830c354f27ea1b43">SE_SERVER_SECURITY</a>) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Server security\n&quot;</span>);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;    }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Owner &quot;</span>);</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    SepPrintSid( Owner );</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Group &quot;</span>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    SepPrintSid( Group );</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Sacl&quot;</span>);</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    SepPrintAcl( Sacl );</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Dacl&quot;</span>);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    SepPrintAcl( Dacl );</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;SepPrintAcl (</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d7/dd4/a00013.html">PACL</a> Acl</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    )</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment">    This routine dumps via (DbgPrint) an Acl for debug purposes.  It is</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment">    specialized to dump standard aces.</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">    Acl - Supplies the Acl to dump</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">    None</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;{</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> i;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <a class="code" href="../../d8/d7d/a00789.html">PKNOWN_ACE</a> Ace;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a> KnownType;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;@ %8lx\n&quot;</span>, Acl);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="comment">//  Check if the Acl is null</span></div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">if</span> (Acl == <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    }</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="comment">//  Dump the Acl header</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Revision: %02x&quot;</span>, Acl-&gt;AclRevision);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Size: %04x&quot;</span>, Acl-&gt;AclSize);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; AceCount: %04x\n&quot;</span>, Acl-&gt;AceCount);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="comment">//  Now for each Ace we want do dump it</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    <span class="keywordflow">for</span> (i = 0, Ace = <a class="code" href="../../df/d4d/a02285.html#a044a6ce7a3a5f71322a2cfb360ac104d">FirstAce</a>(Acl);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;         i &lt; Acl-&gt;AceCount;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;         i++, Ace = <a class="code" href="../../df/d4d/a02285.html#ae95f120ac17a4331773cfc7240498181">NextAce</a>(Ace) ) {</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="comment">//  print out the ace header</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n AceHeader: %08lx &quot;</span>, *(<a class="code" href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a>)Ace);</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">//  special case on the standard ace types</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        <span class="keywordflow">if</span> ((Ace-&gt;Header.AceType == <a class="code" href="../../d3/d3a/a02259.html#a4ef74f2d725a1d8bd1b8d715aef852b9">ACCESS_ALLOWED_ACE_TYPE</a>) ||</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            (Ace-&gt;Header.AceType == <a class="code" href="../../d3/d3a/a02259.html#a9081b9116c6cf606b4ccbee0ece39f5d">ACCESS_DENIED_ACE_TYPE</a>) ||</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            (Ace-&gt;Header.AceType == <a class="code" href="../../d3/d3a/a02259.html#a497809e531ff71f06a1bd80ae7782d90">SYSTEM_AUDIT_ACE_TYPE</a>) ||</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            (Ace-&gt;Header.AceType == <a class="code" href="../../d3/d3a/a02259.html#a7d9e23f817e83da107625e5e40f99cd7">SYSTEM_ALARM_ACE_TYPE</a>) ||</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            (Ace-&gt;Header.AceType == <a class="code" href="../../d3/d3a/a02259.html#abbf861f5f7ab0c3d45df32ffb0ffd1fd">ACCESS_ALLOWED_COMPOUND_ACE_TYPE</a>)) {</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">//  The following array is indexed by ace types and must</span></div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="comment">//  follow the allowed, denied, audit, alarm sequence</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="comment">//</span></div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <a class="code" href="../../dd/d67/a02230.html#a6addcc52e2dfddf231bf3213859ae2bb">PCHAR</a> AceTypes[] = { <span class="stringliteral">&quot;Access Allowed&quot;</span>,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                                 <span class="stringliteral">&quot;Access Denied &quot;</span>,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                                 <span class="stringliteral">&quot;System Audit  &quot;</span>,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;                                 <span class="stringliteral">&quot;System Alarm  &quot;</span>,</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                 <span class="stringliteral">&quot;Compound Grant&quot;</span>,</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                               };</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(AceTypes[Ace-&gt;Header.AceType]);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n Access Mask: %08lx &quot;</span>, Ace-&gt;Mask);</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            KnownType = <a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Unknown Ace Type\n&quot;</span>);</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            KnownType = <a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>;</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; AceSize = %d\n&quot;</span>,Ace-&gt;Header.AceSize);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Ace Flags = &quot;</span>);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#a835b909110f55ce5de0cb58fbf9bdf94">OBJECT_INHERIT_ACE</a>) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;OBJECT_INHERIT_ACE\n&quot;</span>);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;                   &quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#a05913ec4024dd593dae39d59269e365f">CONTAINER_INHERIT_ACE</a>) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;CONTAINER_INHERIT_ACE\n&quot;</span>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;                   &quot;</span>);</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        }</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#a901dc485eba263b56ca12922d4172073">NO_PROPAGATE_INHERIT_ACE</a>) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;NO_PROPAGATE_INHERIT_ACE\n&quot;</span>);</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;                   &quot;</span>);</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#a0b3f598c6ca0b18ba95fe4675d354c48">INHERIT_ONLY_ACE</a>) {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;INHERIT_ONLY_ACE\n&quot;</span>);</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;                   &quot;</span>);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#af432365a7f8156f8c092870edea1329b">SUCCESSFUL_ACCESS_ACE_FLAG</a>) {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;SUCCESSFUL_ACCESS_ACE_FLAG\n&quot;</span>);</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;            &quot;</span>);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceFlags &amp; <a class="code" href="../../d3/d3a/a02259.html#aed93f572f76288c4e5238b805f0f1c24">FAILED_ACCESS_ACE_FLAG</a>) {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;FAILED_ACCESS_ACE_FLAG\n&quot;</span>);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;            &quot;</span>);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordflow">if</span> (KnownType != <a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">if</span> (Ace-&gt;Header.AceType != <a class="code" href="../../d3/d3a/a02259.html#abbf861f5f7ab0c3d45df32ffb0ffd1fd">ACCESS_ALLOWED_COMPOUND_ACE_TYPE</a>) {</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Sid = &quot;</span>);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            SepPrintSid(&amp;Ace-&gt;SidStart);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot; Server Sid = &quot;</span>);</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;            SepPrintSid(<a class="code" href="../../de/dc3/a02256.html#a629256bb2488240a06b6827cc90016a6">RtlCompoundAceServerSid</a>(Ace));</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n Client Sid = &quot;</span>);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            SepPrintSid(<a class="code" href="../../de/dc3/a02256.html#ac2b83a0ab0baf87298094ed858d91248">RtlCompoundAceClientSid</a>( Ace ));</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;}</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;SepPrintSid(</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> Sid</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    )</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="comment">    Prints a formatted Sid</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="comment">    Sid - Provides a pointer to the sid to be printed.</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">    None.</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;{</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> i;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> Tmp;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="../../de/df9/a01624.html">PISID</a> ISid;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="../../d4/d41/a01661.html">STRING</a> <a class="code" href="../../d8/d51/a02244.html#ae2e004c27e6212fe6bd33cc5c6552347">AccountName</a>;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a> <a class="code" href="../../de/dc3/a02256.html#a1f06b5cf5a277b5ecd2579b4f1387ca5">Buffer</a>[128];</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;    <span class="keywordflow">if</span> (Sid == <a class="code" href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Sid is NULL\n&quot;</span>);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    Buffer[0] = 0;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    AccountName.<a class="code" href="../../d4/d41/a01661.html#a51da46a492a3ce1a490f9fa32bb37c0b">MaximumLength</a> = 127;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    AccountName.<a class="code" href="../../d4/d41/a01661.html#a42053951503fd821638234bd01a1c6c7">Length</a> = 0;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    AccountName.<a class="code" href="../../d4/d41/a01661.html#aaaaa56a4176d7ae875eaea419d56799f">Buffer</a> = (<a class="code" href="../../dd/d67/a02230.html#ab27e8a5903617bec9d037e4039ac00a7">PVOID</a>)&amp;Buffer[0];</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="keywordflow">if</span> (SepSidTranslation( Sid, &amp;AccountName )) {</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;%s   &quot;</span>, AccountName.<a class="code" href="../../d4/d41/a01661.html#aaaaa56a4176d7ae875eaea419d56799f">Buffer</a> );</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    ISid = (<a class="code" href="../../d3/d3a/a02259.html#ad30a32f32e06e7bb16b53e0a443eb289">PISID</a>)Sid;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;S-%lu-&quot;</span>, (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#a3cd69b64b8e96f1cf67ab649a2e0795a">Revision</a> );</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="keywordflow">if</span> (  (ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[0] != 0)  ||</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          (ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[1] != 0)     ){</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;0x%02hx%02hx%02hx%02hx%02hx%02hx&quot;</span>,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[0],</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[1],</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[2],</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[3],</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[4],</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                    (<a class="code" href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[5] );</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        Tmp = (<a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>)ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[5]          +</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              (<a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>)(ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[4] &lt;&lt;  8)  +</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              (<a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>)(ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[3] &lt;&lt; 16)  +</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;              (<a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a>)(ISid-&gt;<a class="code" href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">IdentifierAuthority</a>.<a class="code" href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">Value</a>[2] &lt;&lt; 24);</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;%lu&quot;</span>, Tmp);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">for</span> (i=0;i&lt;ISid-&gt;<a class="code" href="../../de/df9/a01624.html#a128c3bab70f681c6df6d7eb7a171e959">SubAuthorityCount</a> ;i++ ) {</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;-%lu&quot;</span>, ISid-&gt;<a class="code" href="../../de/df9/a01624.html#a016791c144978a3390935063f68f1d6b">SubAuthority</a>[i]);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;SepDumpTokenInfo(</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a> <a class="code" href="../../d3/d3a/a02259.html#aded525b11dfac733d993dfeb75564bee">PACCESS_TOKEN</a> Token</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    )</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="comment">    Prints interesting information in a token.</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="comment">    Token - Provides the token to be examined.</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">    None.</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;{</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> UserAndGroupCount;</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <a class="code" href="../../d3/d2d/a01625.html">PSID_AND_ATTRIBUTES</a> TokenSid;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a> i;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="../../df/d2e/a01737.html">PTOKEN</a> IToken;</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">if</span> (!SepDumpToken) {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    IToken = (<a class="code" href="../../df/d2e/a01737.html">TOKEN</a> *)Token;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    UserAndGroupCount = IToken-&gt;<a class="code" href="../../df/d2e/a01737.html#ae0387af3b27556257c656e9f00f69e0b">UserAndGroupCount</a>;</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;\n\nToken Address=%lx\n&quot;</span>,IToken);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Token User and Groups Array:\n\n&quot;</span>);</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="keywordflow">for</span> ( i = 0 , TokenSid = IToken-&gt;<a class="code" href="../../df/d2e/a01737.html#a62d85b0f1dad3f4ca46626ab7a252c75">UserAndGroups</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;          i &lt; UserAndGroupCount ;</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          i++, TokenSid++</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        ) {</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        SepPrintSid( TokenSid-&gt;<a class="code" href="../../d3/d2d/a01625.html#a65626cb95688165a5d004e32a6e48d48">Sid</a> );</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        }</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    <span class="keywordflow">if</span> ( IToken-&gt;<a class="code" href="../../df/d2e/a01737.html#a4ab5b88ed619a843a0b4ee4e0d69135c">RestrictedSids</a> ) {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        UserAndGroupCount = IToken-&gt;<a class="code" href="../../df/d2e/a01737.html#af55db32bf053023261f1db13d943ebea">RestrictedSidCount</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a>(<span class="stringliteral">&quot;Restricted Sids Array:\n\n&quot;</span>);</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        <span class="keywordflow">for</span> ( i = 0 , TokenSid = IToken-&gt;<a class="code" href="../../df/d2e/a01737.html#a4ab5b88ed619a843a0b4ee4e0d69135c">RestrictedSids</a>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;              i &lt; UserAndGroupCount ;</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;              i++, TokenSid++</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;            ) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;            SepPrintSid( TokenSid-&gt;<a class="code" href="../../d3/d2d/a01625.html#a65626cb95688165a5d004e32a6e48d48">Sid</a> );</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;            }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;}</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<a class="code" href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;SepSidTranslation(</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <a class="code" href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a> Sid,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="../../d4/d41/a01661.html">PSTRING</a> AccountName</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    )</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment">/*++</span></div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">Routine Description:</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">    This routine translates well-known SIDs into English names.</span></div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">Arguments:</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="comment">    Sid - Provides the sid to be examined.</span></div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">    AccountName - Provides a string buffer in which to place the</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">        translated name.</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">Return Value:</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">    None</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="comment">--*/</span></div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="comment">// AccountName is expected to have a large maximum length</span></div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;{</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <a class="code" href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a>();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a643a68c1e88c00e3c4138c3fcf8e75ee">SeWorldSid</a>)) {</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;WORLD         &quot;</span>);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    }</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#aa84909c71e62cd4fc2da3a1e484b069e">SeLocalSid</a>)) {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;LOCAL         &quot;</span>);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a71015efa2f0737388cb7977bdebbc865">SeNetworkSid</a>)) {</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;NETWORK       &quot;</span>);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    }</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a47e4281937d40829e19fddd6aa5f9ef5">SeBatchSid</a>)) {</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;BATCH         &quot;</span>);</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    }</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a6323df0892dd49d75e833591d92e2b06">SeInteractiveSid</a>)) {</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;INTERACTIVE   &quot;</span>);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    }</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a01b8784796a544e7e87fd39456cd8f45">SeLocalSystemSid</a>)) {</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;SYSTEM        &quot;</span>);</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    }</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#ab79aaa1bc5d789c978a19f6934dff5d4">SeCreatorOwnerSid</a>)) {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;CREATOR_OWNER &quot;</span>);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a7e011c93ee1075507e9655c1d6651df0">SeCreatorGroupSid</a>)) {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;CREATOR_GROUP &quot;</span>);</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#a53d49f6cdcb254b4693727189c421266">SeCreatorOwnerServerSid</a>)) {</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;CREATOR_OWNER_SERVER &quot;</span>);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a>(Sid, <a class="code" href="../../d3/d81/a02284.html#aa41ade34f84ea7003e934c1868ea48df">SeCreatorGroupServerSid</a>)) {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <a class="code" href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a>( AccountName, <span class="stringliteral">&quot;CREATOR_GROUP_SERVER &quot;</span>);</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    }</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">return</span>(<a class="code" href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>);</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;}</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">//  End debug only routines</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="preprocessor">#endif //DBG</span></div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;</div>
<div class="ttc" id="a02369_html_ac72f24fb0e57feffb445dd9456b8597a"><div class="ttname"><a href="../../df/def/a02369.html#ac72f24fb0e57feffb445dd9456b8597a">Group</a></div><div class="ttdeci">ULONG Group</div><div class="ttdef"><b>Definition:</b> <a href="../../df/def/a02369_source.html#l00130">decode.c:130</a></div></div>
<div class="ttc" id="a02230_html_ac2bbd6d630a06a980d9a92ddb9a49928"><div class="ttname"><a href="../../dd/d67/a02230.html#ac2bbd6d630a06a980d9a92ddb9a49928">IN</a></div><div class="ttdeci">#define IN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00031">ntdef.h:31</a></div></div>
<div class="ttc" id="a02259_html_a5bdc6aa90cb7276fc7e2523b65e3556e"><div class="ttname"><a href="../../d3/d3a/a02259.html#a5bdc6aa90cb7276fc7e2523b65e3556e">PSECURITY_DESCRIPTOR</a></div><div class="ttdeci">PVOID PSECURITY_DESCRIPTOR</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00059">ntseapi.h:59</a></div></div>
<div class="ttc" id="a01624_html_a3cd69b64b8e96f1cf67ab649a2e0795a"><div class="ttname"><a href="../../de/df9/a01624.html#a3cd69b64b8e96f1cf67ab649a2e0795a">_SID::Revision</a></div><div class="ttdeci">UCHAR Revision</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00252">ntseapi.h:252</a></div></div>
<div class="ttc" id="a02284_html_ab79aaa1bc5d789c978a19f6934dff5d4"><div class="ttname"><a href="../../d3/d81/a02284.html#ab79aaa1bc5d789c978a19f6934dff5d4">SeCreatorOwnerSid</a></div><div class="ttdeci">PSID SeCreatorOwnerSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00084">seglobal.c:84</a></div></div>
<div class="ttc" id="a02230_html_a1cb18096b299d23458d3c7b85fd86555"><div class="ttname"><a href="../../dd/d67/a02230.html#a1cb18096b299d23458d3c7b85fd86555">BOOLEAN</a></div><div class="ttdeci">UCHAR BOOLEAN</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01073">ntdef.h:1073</a></div></div>
<div class="ttc" id="a01737_html_a4ab5b88ed619a843a0b4ee4e0d69135c"><div class="ttname"><a href="../../df/d2e/a01737.html#a4ab5b88ed619a843a0b4ee4e0d69135c">_TOKEN::RestrictedSids</a></div><div class="ttdeci">PSID_AND_ATTRIBUTES RestrictedSids</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d0f/a02707_source.html#l00284">tokenp.h:284</a></div></div>
<div class="ttc" id="a01624_html_a016791c144978a3390935063f68f1d6b"><div class="ttname"><a href="../../de/df9/a01624.html#a016791c144978a3390935063f68f1d6b">_SID::SubAuthority</a></div><div class="ttdeci">ULONG SubAuthority[ANYSIZE_ARRAY]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00258">ntseapi.h:258</a></div></div>
<div class="ttc" id="a02259_html_a209f30ceb819d151d3e4479960b65fef"><div class="ttname"><a href="../../d3/d3a/a02259.html#a209f30ceb819d151d3e4479960b65fef">DACL_SECURITY_INFORMATION</a></div><div class="ttdeci">#define DACL_SECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01775">ntseapi.h:1775</a></div></div>
<div class="ttc" id="a01585_html"><div class="ttname"><a href="../../da/de2/a01585.html">_SECURITY_DESCRIPTOR</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01173">ntseapi.h:1173</a></div></div>
<div class="ttc" id="a02256_html_ac2b83a0ab0baf87298094ed858d91248"><div class="ttname"><a href="../../de/dc3/a02256.html#ac2b83a0ab0baf87298094ed858d91248">RtlCompoundAceClientSid</a></div><div class="ttdeci">#define RtlCompoundAceClientSid(Ace)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l06928">ntrtl.h:6928</a></div></div>
<div class="ttc" id="a02286_html_ab3a29f850b47635960753778305a0f82"><div class="ttname"><a href="../../db/d2d/a02286.html#ab3a29f850b47635960753778305a0f82">RtlpSaclAddrSecurityDescriptor</a></div><div class="ttdeci">#define RtlpSaclAddrSecurityDescriptor(SD)                                                                  </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00075">sertlp.h:75</a></div></div>
<div class="ttc" id="a02259_html_a6a17154ddd8ee109a4deeb874f14264e"><div class="ttname"><a href="../../d3/d3a/a02259.html#a6a17154ddd8ee109a4deeb874f14264e">SE_SACL_DEFAULTED</a></div><div class="ttdeci">#define SE_SACL_DEFAULTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01061">ntseapi.h:1061</a></div></div>
<div class="ttc" id="a02286_html_a6ee5ac6666d1a87f20ff1e63cdc124f9"><div class="ttname"><a href="../../db/d2d/a02286.html#a6ee5ac6666d1a87f20ff1e63cdc124f9">RtlpNewSecurityObject</a></div><div class="ttdeci">NTSTATUS RtlpNewSecurityObject(IN PSECURITY_DESCRIPTOR ParentDescriptor OPTIONAL, IN PSECURITY_DESCRIPTOR CreatorDescriptor OPTIONAL, OUT PSECURITY_DESCRIPTOR *NewDescriptor, IN GUID **pObjectType OPTIONAL, IN ULONG GuidCOunt, IN BOOLEAN IsDirectoryObject, IN ULONG AutoInheritFlags, IN HANDLE Token OPTIONAL, IN PGENERIC_MAPPING GenericMapping)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l08275">sertl.c:8275</a></div></div>
<div class="ttc" id="a02685_html"><div class="ttname"><a href="../../d8/dd8/a02685.html">pch.h</a></div></div>
<div class="ttc" id="a02230_html_a253b627decfeb8fee3765eba6d720d74"><div class="ttname"><a href="../../dd/d67/a02230.html#a253b627decfeb8fee3765eba6d720d74">PULONG</a></div><div class="ttdeci">ULONG * PULONG</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00401">ntdef.h:401</a></div></div>
<div class="ttc" id="a02259_html_a901dc485eba263b56ca12922d4172073"><div class="ttname"><a href="../../d3/d3a/a02259.html#a901dc485eba263b56ca12922d4172073">NO_PROPAGATE_INHERIT_ACE</a></div><div class="ttdeci">#define NO_PROPAGATE_INHERIT_ACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00742">ntseapi.h:742</a></div></div>
<div class="ttc" id="a02285_html_ae95f120ac17a4331773cfc7240498181"><div class="ttname"><a href="../../df/d4d/a02285.html#ae95f120ac17a4331773cfc7240498181">NextAce</a></div><div class="ttdeci">#define NextAce(Ace)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d4d/a02285_source.html#l00140">seopaque.h:140</a></div></div>
<div class="ttc" id="a02259_html_ab1cf9e99656615972a3407e5d72574b5"><div class="ttname"><a href="../../d3/d3a/a02259.html#ab1cf9e99656615972a3407e5d72574b5">GROUP_SECURITY_INFORMATION</a></div><div class="ttdeci">#define GROUP_SECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01774">ntseapi.h:1774</a></div></div>
<div class="ttc" id="a02261_html_a59d287bcfe603ad0d4b5a330be02d22d"><div class="ttname"><a href="../../d7/d24/a02261.html#a59d287bcfe603ad0d4b5a330be02d22d">SEF_DACL_AUTO_INHERIT</a></div><div class="ttdeci">#define SEF_DACL_AUTO_INHERIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d24/a02261_source.html#l00919">nturtl.h:919</a></div></div>
<div class="ttc" id="a02284_html_a71015efa2f0737388cb7977bdebbc865"><div class="ttname"><a href="../../d3/d81/a02284.html#a71015efa2f0737388cb7977bdebbc865">SeNetworkSid</a></div><div class="ttdeci">PSID SeNetworkSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00096">seglobal.c:96</a></div></div>
<div class="ttc" id="a01624_html"><div class="ttname"><a href="../../de/df9/a01624.html">_SID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00251">ntseapi.h:251</a></div></div>
<div class="ttc" id="a02230_html_a284f59a7515ae016d59a07190930d155"><div class="ttname"><a href="../../dd/d67/a02230.html#a284f59a7515ae016d59a07190930d155">ARGUMENT_PRESENT</a></div><div class="ttdeci">#define ARGUMENT_PRESENT(ArgumentPointer)    </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01313">ntdef.h:1313</a></div></div>
<div class="ttc" id="a02259_html_a61cf327633d2a19c13477bda23e517ad"><div class="ttname"><a href="../../d3/d3a/a02259.html#a61cf327633d2a19c13477bda23e517ad">PISECURITY_DESCRIPTOR</a></div><div class="ttdeci">struct _SECURITY_DESCRIPTOR * PISECURITY_DESCRIPTOR</div></div>
<div class="ttc" id="a02184_html_a32a1467b2542bf2a6384f6fc19953bddae0942a3b0a37bffc44d7b2d63e116ef1"><div class="ttname"><a href="../../d5/ddd/a02184.html#a32a1467b2542bf2a6384f6fc19953bddae0942a3b0a37bffc44d7b2d63e116ef1">PagedPool</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d5/ddd/a02184_source.html#l00106">ex.h:106</a></div></div>
<div class="ttc" id="a02230_html_a7f319bfc2492a2136964194204e7a8cf"><div class="ttname"><a href="../../dd/d67/a02230.html#a7f319bfc2492a2136964194204e7a8cf">VOID</a></div><div class="ttdeci">#define VOID</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00288">ntdef.h:288</a></div></div>
<div class="ttc" id="a02259_html_a4ef74f2d725a1d8bd1b8d715aef852b9"><div class="ttname"><a href="../../d3/d3a/a02259.html#a4ef74f2d725a1d8bd1b8d715aef852b9">ACCESS_ALLOWED_ACE_TYPE</a></div><div class="ttdeci">#define ACCESS_ALLOWED_ACE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00700">ntseapi.h:700</a></div></div>
<div class="ttc" id="a02259_html_a4f4058db98443ea272a9017c4cd374f6"><div class="ttname"><a href="../../d3/d3a/a02259.html#a4f4058db98443ea272a9017c4cd374f6">PSECURITY_INFORMATION</a></div><div class="ttdeci">ULONG * PSECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01771">ntseapi.h:1771</a></div></div>
<div class="ttc" id="a01585_html_aedf674c652a73f50f9a896b2497f1409"><div class="ttname"><a href="../../da/de2/a01585.html#aedf674c652a73f50f9a896b2497f1409">_SECURITY_DESCRIPTOR::Control</a></div><div class="ttdeci">SECURITY_DESCRIPTOR_CONTROL Control</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01176">ntseapi.h:1176</a></div></div>
<div class="ttc" id="a01591_html"><div class="ttname"><a href="../../dc/d42/a01591.html">_SECURITY_SUBJECT_CONTEXT</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d81/a02284_source.html#l00098">se.h:98</a></div></div>
<div class="ttc" id="a02259_html_af8a3094a4a40ef8d0e5eee5012e827d4"><div class="ttname"><a href="../../d3/d3a/a02259.html#af8a3094a4a40ef8d0e5eee5012e827d4">SE_DACL_PRESENT</a></div><div class="ttdeci">#define SE_DACL_PRESENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01058">ntseapi.h:1058</a></div></div>
<div class="ttc" id="a01585_html_a04d07191f19edda54e63353837a588a7"><div class="ttname"><a href="../../da/de2/a01585.html#a04d07191f19edda54e63353837a588a7">_SECURITY_DESCRIPTOR::Revision</a></div><div class="ttdeci">UCHAR Revision</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01174">ntseapi.h:1174</a></div></div>
<div class="ttc" id="a02260_html_a1b28d9f0fc2ca4517f6c0606efb4e0f5"><div class="ttname"><a href="../../dc/d18/a02260.html#a1b28d9f0fc2ca4517f6c0606efb4e0f5">STATUS_NO_INHERITANCE</a></div><div class="ttdeci">#define STATUS_NO_INHERITANCE</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/a02260_source.html#l01141">ntstatus.h:1141</a></div></div>
<div class="ttc" id="a00521_html"><div class="ttname"><a href="../../d7/def/a00521.html">_GENERIC_MAPPING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00174">ntseapi.h:174</a></div></div>
<div class="ttc" id="a02259_html_abfbebcb07a24f698a6c04b3bc0ad32f4"><div class="ttname"><a href="../../d3/d3a/a02259.html#abfbebcb07a24f698a6c04b3bc0ad32f4">SE_GROUP_DEFAULTED</a></div><div class="ttdeci">#define SE_GROUP_DEFAULTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01057">ntseapi.h:1057</a></div></div>
<div class="ttc" id="a02259_html_aded525b11dfac733d993dfeb75564bee"><div class="ttname"><a href="../../d3/d3a/a02259.html#aded525b11dfac733d993dfeb75564bee">PACCESS_TOKEN</a></div><div class="ttdeci">PVOID PACCESS_TOKEN</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00053">ntseapi.h:53</a></div></div>
<div class="ttc" id="a02289_html_a274c77397b30c926ba3e01b7b72726fa"><div class="ttname"><a href="../../de/d4e/a02289.html#a274c77397b30c926ba3e01b7b72726fa">__deref_inout</a></div><div class="ttdeci">#define __deref_inout</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00547">specstrings.h:547</a></div></div>
<div class="ttc" id="a02289_html_a26417a011a3b2059a493df059768499e"><div class="ttname"><a href="../../de/d4e/a02289.html#a26417a011a3b2059a493df059768499e">__inout_bcount_part</a></div><div class="ttdeci">#define __inout_bcount_part(size, length)                                            </div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00511">specstrings.h:511</a></div></div>
<div class="ttc" id="a02261_html_ab31f4c0fab101f20d852eb7b68b57cd4"><div class="ttname"><a href="../../d7/d24/a02261.html#ab31f4c0fab101f20d852eb7b68b57cd4">SEF_SACL_AUTO_INHERIT</a></div><div class="ttdeci">#define SEF_SACL_AUTO_INHERIT</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d24/a02261_source.html#l00920">nturtl.h:920</a></div></div>
<div class="ttc" id="a02284_html_aa84909c71e62cd4fc2da3a1e484b069e"><div class="ttname"><a href="../../d3/d81/a02284.html#aa84909c71e62cd4fc2da3a1e484b069e">SeLocalSid</a></div><div class="ttdeci">PSID SeLocalSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00083">seglobal.c:83</a></div></div>
<div class="ttc" id="a02244_html_a1eba21559f17793c695f34f7e4787604"><div class="ttname"><a href="../../d8/d51/a02244.html#a1eba21559f17793c695f34f7e4787604">Length</a></div><div class="ttdeci">IN ULONG Length</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/a02244_source.html#l01051">ntlsa.h:1051</a></div></div>
<div class="ttc" id="a02259_html_a72b025cb2be68de4fd11bdb82c21fd96"><div class="ttname"><a href="../../d3/d3a/a02259.html#a72b025cb2be68de4fd11bdb82c21fd96">SE_SACL_AUTO_INHERITED</a></div><div class="ttdeci">#define SE_SACL_AUTO_INHERITED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01069">ntseapi.h:1069</a></div></div>
<div class="ttc" id="a01661_html_a51da46a492a3ce1a490f9fa32bb37c0b"><div class="ttname"><a href="../../d4/d41/a01661.html#a51da46a492a3ce1a490f9fa32bb37c0b">_STRING::MaximumLength</a></div><div class="ttdeci">USHORT MaximumLength</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01008">ntdef.h:1008</a></div></div>
<div class="ttc" id="a02259_html_a05913ec4024dd593dae39d59269e365f"><div class="ttname"><a href="../../d3/d3a/a02259.html#a05913ec4024dd593dae39d59269e365f">CONTAINER_INHERIT_ACE</a></div><div class="ttdeci">#define CONTAINER_INHERIT_ACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00741">ntseapi.h:741</a></div></div>
<div class="ttc" id="a02230_html_aa8c0374618b33785ccb02f74bcfebc46"><div class="ttname"><a href="../../dd/d67/a02230.html#aa8c0374618b33785ccb02f74bcfebc46">HANDLE</a></div><div class="ttdeci">void * HANDLE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00424">ntdef.h:424</a></div></div>
<div class="ttc" id="a02230_html_aa8cecfc5c5c054d2875c03e77b7be15d"><div class="ttname"><a href="../../dd/d67/a02230.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a></div><div class="ttdeci">#define TRUE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01263">ntdef.h:1263</a></div></div>
<div class="ttc" id="a01737_html_af55db32bf053023261f1db13d943ebea"><div class="ttname"><a href="../../df/d2e/a01737.html#af55db32bf053023261f1db13d943ebea">_TOKEN::RestrictedSidCount</a></div><div class="ttdeci">ULONG RestrictedSidCount</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d0f/a02707_source.html#l00276">tokenp.h:276</a></div></div>
<div class="ttc" id="a02284_html_a01b8784796a544e7e87fd39456cd8f45"><div class="ttname"><a href="../../d3/d81/a02284.html#a01b8784796a544e7e87fd39456cd8f45">SeLocalSystemSid</a></div><div class="ttdeci">PSID SeLocalSystemSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00101">seglobal.c:101</a></div></div>
<div class="ttc" id="a01626_html_af20114433ef94ae999cbd2b8c9ec6b4b"><div class="ttname"><a href="../../dd/d90/a01626.html#af20114433ef94ae999cbd2b8c9ec6b4b">_SID_IDENTIFIER_AUTHORITY::Value</a></div><div class="ttdeci">UCHAR Value[6]</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00244">ntseapi.h:244</a></div></div>
<div class="ttc" id="a02256_html_a3ecb761d115f3f4f332adcf2156e4f8e"><div class="ttname"><a href="../../de/dc3/a02256.html#a3ecb761d115f3f4f332adcf2156e4f8e">RtlInitString</a></div><div class="ttdeci">NTSYSAPI VOID NTAPI RtlInitString(PSTRING DestinationString, PCSZ SourceString)</div></div>
<div class="ttc" id="a02286_html_a1ae5ed7f5a2f3d50dc653c7d1e9de539"><div class="ttname"><a href="../../db/d2d/a02286.html#a1ae5ed7f5a2f3d50dc653c7d1e9de539">RtlpGroupAddrSecurityDescriptor</a></div><div class="ttdeci">#define RtlpGroupAddrSecurityDescriptor(SD)                                                                </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00067">sertlp.h:67</a></div></div>
<div class="ttc" id="a01737_html_ae0387af3b27556257c656e9f00f69e0b"><div class="ttname"><a href="../../df/d2e/a01737.html#ae0387af3b27556257c656e9f00f69e0b">_TOKEN::UserAndGroupCount</a></div><div class="ttdeci">ULONG UserAndGroupCount</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d0f/a02707_source.html#l00275">tokenp.h:275</a></div></div>
<div class="ttc" id="a01587_html_aa24ad3c48067e3f489f174c08beebdb4"><div class="ttname"><a href="../../d6/d91/a01587.html#aa24ad3c48067e3f489f174c08beebdb4">_SECURITY_DESCRIPTOR_RELATIVE::Group</a></div><div class="ttdeci">ULONG Group</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01168">ntseapi.h:1168</a></div></div>
<div class="ttc" id="a02284_html_a643a68c1e88c00e3c4138c3fcf8e75ee"><div class="ttname"><a href="../../d3/d81/a02284.html#a643a68c1e88c00e3c4138c3fcf8e75ee">SeWorldSid</a></div><div class="ttdeci">PSID SeWorldSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00082">seglobal.c:82</a></div></div>
<div class="ttc" id="a02285_html_a044a6ce7a3a5f71322a2cfb360ac104d"><div class="ttname"><a href="../../df/d4d/a02285.html#a044a6ce7a3a5f71322a2cfb360ac104d">FirstAce</a></div><div class="ttdeci">#define FirstAce(Acl)</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d4d/a02285_source.html#l00134">seopaque.h:134</a></div></div>
<div class="ttc" id="a02256_html_ab49350da23720546beb60b8054facd9c"><div class="ttname"><a href="../../de/dc3/a02256.html#ab49350da23720546beb60b8054facd9c">ASSERT</a></div><div class="ttdeci">#define ASSERT(exp)              </div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l00286">ntrtl.h:286</a></div></div>
<div class="ttc" id="a02692_html_a0c3ef3142d6465d6a70feddd163abc0d"><div class="ttname"><a href="../../d2/dba/a02692.html#a0c3ef3142d6465d6a70feddd163abc0d">SepInheritAcl</a></div><div class="ttdeci">NTSTATUS SepInheritAcl(IN PACL Acl, IN BOOLEAN IsDirectoryObject, IN PSID OwnerSid, IN PSID GroupSid, IN PSID ServerSid OPTIONAL, IN PSID ClientSid OPTIONAL, IN PGENERIC_MAPPING GenericMapping, IN POOL_TYPE PoolType, OUT PACL *NewAcl)</div></div>
<div class="ttc" id="a02044_html_a8d0307cc6eebba297dba1b97a0a7618e"><div class="ttname"><a href="../../d8/d22/a02044.html#a8d0307cc6eebba297dba1b97a0a7618e">Status</a></div><div class="ttdeci">ULONG Status</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d22/a02044_source.html#l00083">cmchek.c:83</a></div></div>
<div class="ttc" id="a02230_html_adced8a140f55db5bbb1e36a4bd987926"><div class="ttname"><a href="../../dd/d67/a02230.html#adced8a140f55db5bbb1e36a4bd987926">PSZ</a></div><div class="ttdeci">CHAR * PSZ</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00996">ntdef.h:996</a></div></div>
<div class="ttc" id="a02256_html_aec84fe2ac482efd50b064cfd45772cef"><div class="ttname"><a href="../../de/dc3/a02256.html#aec84fe2ac482efd50b064cfd45772cef">RtlCreateSecurityDescriptorRelative</a></div><div class="ttdeci">NTSYSAPI NTSTATUS NTAPI RtlCreateSecurityDescriptorRelative(PISECURITY_DESCRIPTOR_RELATIVE SecurityDescriptor, ULONG Revision)</div></div>
<div class="ttc" id="a01737_html_a62d85b0f1dad3f4ca46626ab7a252c75"><div class="ttname"><a href="../../df/d2e/a01737.html#a62d85b0f1dad3f4ca46626ab7a252c75">_TOKEN::UserAndGroups</a></div><div class="ttdeci">PSID_AND_ATTRIBUTES UserAndGroups</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d0f/a02707_source.html#l00283">tokenp.h:283</a></div></div>
<div class="ttc" id="a02692_html_a814c538ea35b1d0c22c7d7d7ca2bb46d"><div class="ttname"><a href="../../d2/dba/a02692.html#a814c538ea35b1d0c22c7d7d7ca2bb46d">SeAssignWorldSecurityDescriptor</a></div><div class="ttdeci">NTSTATUS SeAssignWorldSecurityDescriptor(__inout_bcount_part(*Length,*Length) PSECURITY_DESCRIPTOR SecurityDescriptor, __inout PULONG Length, __in PSECURITY_INFORMATION SecurityInformation)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dba/a02692_source.html#l00519">seassign.c:519</a></div></div>
<div class="ttc" id="a02256_html_a1f06b5cf5a277b5ecd2579b4f1387ca5"><div class="ttname"><a href="../../de/dc3/a02256.html#a1f06b5cf5a277b5ecd2579b4f1387ca5">Buffer</a></div><div class="ttdeci">PVOID Buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l00563">ntrtl.h:563</a></div></div>
<div class="ttc" id="a02259_html_ad7d3e853b74bd0e483fa2c6107fb69fd"><div class="ttname"><a href="../../d3/d3a/a02259.html#ad7d3e853b74bd0e483fa2c6107fb69fd">SACL_SECURITY_INFORMATION</a></div><div class="ttdeci">#define SACL_SECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01776">ntseapi.h:1776</a></div></div>
<div class="ttc" id="a02259_html_a783c8ad3877adc922b1184d3bfd83189"><div class="ttname"><a href="../../d3/d3a/a02259.html#a783c8ad3877adc922b1184d3bfd83189">PSID</a></div><div class="ttdeci">PVOID PSID</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00065">ntseapi.h:65</a></div></div>
<div class="ttc" id="a01661_html_a42053951503fd821638234bd01a1c6c7"><div class="ttname"><a href="../../d4/d41/a01661.html#a42053951503fd821638234bd01a1c6c7">_STRING::Length</a></div><div class="ttdeci">USHORT Length</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01007">ntdef.h:1007</a></div></div>
<div class="ttc" id="a02259_html_a9081b9116c6cf606b4ccbee0ece39f5d"><div class="ttname"><a href="../../d3/d3a/a02259.html#a9081b9116c6cf606b4ccbee0ece39f5d">ACCESS_DENIED_ACE_TYPE</a></div><div class="ttdeci">#define ACCESS_DENIED_ACE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00701">ntseapi.h:701</a></div></div>
<div class="ttc" id="a01587_html"><div class="ttname"><a href="../../d6/d91/a01587.html">_SECURITY_DESCRIPTOR_RELATIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01163">ntseapi.h:1163</a></div></div>
<div class="ttc" id="a02259_html_a23a254f5381c9262ec2c236a0e1f62f1"><div class="ttname"><a href="../../d3/d3a/a02259.html#a23a254f5381c9262ec2c236a0e1f62f1">SE_DACL_DEFAULTED</a></div><div class="ttdeci">#define SE_DACL_DEFAULTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01059">ntseapi.h:1059</a></div></div>
<div class="ttc" id="a01661_html_aaaaa56a4176d7ae875eaea419d56799f"><div class="ttname"><a href="../../d4/d41/a01661.html#aaaaa56a4176d7ae875eaea419d56799f">_STRING::Buffer</a></div><div class="ttdeci">PCHAR Buffer</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01012">ntdef.h:1012</a></div></div>
<div class="ttc" id="a01624_html_a128c3bab70f681c6df6d7eb7a171e959"><div class="ttname"><a href="../../de/df9/a01624.html#a128c3bab70f681c6df6d7eb7a171e959">_SID::SubAuthorityCount</a></div><div class="ttdeci">UCHAR SubAuthorityCount</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00253">ntseapi.h:253</a></div></div>
<div class="ttc" id="a02259_html_a0b3f598c6ca0b18ba95fe4675d354c48"><div class="ttname"><a href="../../d3/d3a/a02259.html#a0b3f598c6ca0b18ba95fe4675d354c48">INHERIT_ONLY_ACE</a></div><div class="ttdeci">#define INHERIT_ONLY_ACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00743">ntseapi.h:743</a></div></div>
<div class="ttc" id="a02692_html_a8049502f7317002f2e438e5821ee3997"><div class="ttname"><a href="../../d2/dba/a02692.html#a8049502f7317002f2e438e5821ee3997">SeAssignSecurityEx</a></div><div class="ttdeci">NTSTATUS SeAssignSecurityEx(__in_opt PSECURITY_DESCRIPTOR ParentDescriptor, __in_opt PSECURITY_DESCRIPTOR ExplicitDescriptor, __out PSECURITY_DESCRIPTOR *NewDescriptor, __in_opt GUID *ObjectType, __in BOOLEAN IsDirectoryObject, __in ULONG AutoInheritFlags, __in PSECURITY_SUBJECT_CONTEXT SubjectContext, __in PGENERIC_MAPPING GenericMapping, __in POOL_TYPE PoolType)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dba/a02692_source.html#l00216">seassign.c:216</a></div></div>
<div class="ttc" id="a02259_html_a5dcdcb687d0ee6009b792fe98286b02f"><div class="ttname"><a href="../../d3/d3a/a02259.html#a5dcdcb687d0ee6009b792fe98286b02f">SECURITY_DESCRIPTOR_CONTROL</a></div><div class="ttdeci">USHORT SECURITY_DESCRIPTOR_CONTROL</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01054">ntseapi.h:1054</a></div></div>
<div class="ttc" id="a02230_html_aa93f0eb578d23995850d61f7d61c55c1"><div class="ttname"><a href="../../dd/d67/a02230.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a></div><div class="ttdeci">#define FALSE</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01262">ntdef.h:1262</a></div></div>
<div class="ttc" id="a01661_html"><div class="ttname"><a href="../../d4/d41/a01661.html">_STRING</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01006">ntdef.h:1006</a></div></div>
<div class="ttc" id="a02284_html_a6b4016db9802d1ca4d0c566f618ff03e"><div class="ttname"><a href="../../d3/d81/a02284.html#a6b4016db9802d1ca4d0c566f618ff03e">SeLengthSid</a></div><div class="ttdeci">#define SeLengthSid(Sid)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d81/a02284_source.html#l00558">se.h:558</a></div></div>
<div class="ttc" id="a02259_html_a7d9e23f817e83da107625e5e40f99cd7"><div class="ttname"><a href="../../d3/d3a/a02259.html#a7d9e23f817e83da107625e5e40f99cd7">SYSTEM_ALARM_ACE_TYPE</a></div><div class="ttdeci">#define SYSTEM_ALARM_ACE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00703">ntseapi.h:703</a></div></div>
<div class="ttc" id="a02284_html_a53d49f6cdcb254b4693727189c421266"><div class="ttname"><a href="../../d3/d81/a02284.html#a53d49f6cdcb254b4693727189c421266">SeCreatorOwnerServerSid</a></div><div class="ttdeci">PSID SeCreatorOwnerServerSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00087">seglobal.c:87</a></div></div>
<div class="ttc" id="a02289_html_a9c2d0f2980e51b51bb405ee2a31a3353"><div class="ttname"><a href="../../de/d4e/a02289.html#a9c2d0f2980e51b51bb405ee2a31a3353">__in_opt</a></div><div class="ttdeci">#define __in_opt</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00517">specstrings.h:517</a></div></div>
<div class="ttc" id="a02260_html_ac978cc4096a590979ae52c9fd4f62ee0"><div class="ttname"><a href="../../dc/d18/a02260.html#ac978cc4096a590979ae52c9fd4f62ee0">STATUS_BUFFER_TOO_SMALL</a></div><div class="ttdeci">#define STATUS_BUFFER_TOO_SMALL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/a02260_source.html#l01852">ntstatus.h:1852</a></div></div>
<div class="ttc" id="a02260_html_a415c67a7a97e52ebee39db8c3addfd4d"><div class="ttname"><a href="../../dc/d18/a02260.html#a415c67a7a97e52ebee39db8c3addfd4d">STATUS_ACCESS_DENIED</a></div><div class="ttdeci">#define STATUS_ACCESS_DENIED</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/a02260_source.html#l01842">ntstatus.h:1842</a></div></div>
<div class="ttc" id="a02259_html_aecc9f2cb4b77c249451b1db76791af53"><div class="ttname"><a href="../../d3/d3a/a02259.html#aecc9f2cb4b77c249451b1db76791af53">SECURITY_DESCRIPTOR_RELATIVE</a></div><div class="ttdeci">struct _SECURITY_DESCRIPTOR_RELATIVE SECURITY_DESCRIPTOR_RELATIVE</div></div>
<div class="ttc" id="a02230_html_a4f4bb67531a9bf6f0b9c6ad76aeba587"><div class="ttname"><a href="../../dd/d67/a02230.html#a4f4bb67531a9bf6f0b9c6ad76aeba587">UCHAR</a></div><div class="ttdeci">unsigned char UCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00390">ntdef.h:390</a></div></div>
<div class="ttc" id="a02256_html_a7dac7ee67fd8470847e01b44f980cae6"><div class="ttname"><a href="../../de/dc3/a02256.html#a7dac7ee67fd8470847e01b44f980cae6">RtlPointerToOffset</a></div><div class="ttdeci">#define RtlPointerToOffset(B, P)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l05695">ntrtl.h:5695</a></div></div>
<div class="ttc" id="a02256_html_aab05afc2eabef1f27a5d5c4c0d629c80"><div class="ttname"><a href="../../de/dc3/a02256.html#aab05afc2eabef1f27a5d5c4c0d629c80">DbgPrint</a></div><div class="ttdeci">ULONG __cdecl DbgPrint(__in PCH Format,...)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc9/a02414_source.html#l00041">debug.c:41</a></div></div>
<div class="ttc" id="a02259_html_a497809e531ff71f06a1bd80ae7782d90"><div class="ttname"><a href="../../d3/d3a/a02259.html#a497809e531ff71f06a1bd80ae7782d90">SYSTEM_AUDIT_ACE_TYPE</a></div><div class="ttdeci">#define SYSTEM_AUDIT_ACE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00702">ntseapi.h:702</a></div></div>
<div class="ttc" id="a00013_html"><div class="ttname"><a href="../../d7/dd4/a00013.html">_ACL</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00658">ntseapi.h:658</a></div></div>
<div class="ttc" id="a02230_html_a6addcc52e2dfddf231bf3213859ae2bb"><div class="ttname"><a href="../../dd/d67/a02230.html#a6addcc52e2dfddf231bf3213859ae2bb">PCHAR</a></div><div class="ttdeci">CHAR * PCHAR</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00313">ntdef.h:313</a></div></div>
<div class="ttc" id="a02230_html_a5850d5316caf7f4cedd742fdf8cd7c02"><div class="ttname"><a href="../../dd/d67/a02230.html#a5850d5316caf7f4cedd742fdf8cd7c02">USHORT</a></div><div class="ttdeci">unsigned short USHORT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00391">ntdef.h:391</a></div></div>
<div class="ttc" id="a02256_html_ab329f640d89ba58a8e81e19004bdb7bd"><div class="ttname"><a href="../../de/dc3/a02256.html#ab329f640d89ba58a8e81e19004bdb7bd">RtlCopyMemory</a></div><div class="ttdeci">#define RtlCopyMemory(Destination, Source, Length)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l04266">ntrtl.h:4266</a></div></div>
<div class="ttc" id="a02259_html_abbf861f5f7ab0c3d45df32ffb0ffd1fd"><div class="ttname"><a href="../../d3/d3a/a02259.html#abbf861f5f7ab0c3d45df32ffb0ffd1fd">ACCESS_ALLOWED_COMPOUND_ACE_TYPE</a></div><div class="ttdeci">#define ACCESS_ALLOWED_COMPOUND_ACE_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00706">ntseapi.h:706</a></div></div>
<div class="ttc" id="a02256_html_a629256bb2488240a06b6827cc90016a6"><div class="ttname"><a href="../../de/dc3/a02256.html#a629256bb2488240a06b6827cc90016a6">RtlCompoundAceServerSid</a></div><div class="ttdeci">#define RtlCompoundAceServerSid(Ace)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/dc3/a02256_source.html#l06926">ntrtl.h:6926</a></div></div>
<div class="ttc" id="a01624_html_ad8ef3ca4f98f30abbadebf247214256e"><div class="ttname"><a href="../../de/df9/a01624.html#ad8ef3ca4f98f30abbadebf247214256e">_SID::IdentifierAuthority</a></div><div class="ttdeci">SID_IDENTIFIER_AUTHORITY IdentifierAuthority</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00254">ntseapi.h:254</a></div></div>
<div class="ttc" id="a02259_html_a974c8776187280aecce79aa09411978a"><div class="ttname"><a href="../../d3/d3a/a02259.html#a974c8776187280aecce79aa09411978a">SE_SACL_PRESENT</a></div><div class="ttdeci">#define SE_SACL_PRESENT</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01060">ntseapi.h:1060</a></div></div>
<div class="ttc" id="a02259_html_af432365a7f8156f8c092870edea1329b"><div class="ttname"><a href="../../d3/d3a/a02259.html#af432365a7f8156f8c092870edea1329b">SUCCESSFUL_ACCESS_ACE_FLAG</a></div><div class="ttdeci">#define SUCCESSFUL_ACCESS_ACE_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00765">ntseapi.h:765</a></div></div>
<div class="ttc" id="a02259_html_a6243776f2306b552ea5cccf5b9873cef"><div class="ttname"><a href="../../d3/d3a/a02259.html#a6243776f2306b552ea5cccf5b9873cef">SE_SELF_RELATIVE</a></div><div class="ttdeci">#define SE_SELF_RELATIVE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01073">ntseapi.h:1073</a></div></div>
<div class="ttc" id="a02230_html_ad14231612b7a675d33f0ead0b695d21a"><div class="ttname"><a href="../../dd/d67/a02230.html#ad14231612b7a675d33f0ead0b695d21a">NT_SUCCESS</a></div><div class="ttdeci">#define NT_SUCCESS(Status)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00569">ntdef.h:569</a></div></div>
<div class="ttc" id="a02692_html_ac4c6b8d37cddc1b71392bf478ce9c653"><div class="ttname"><a href="../../d2/dba/a02692.html#ac4c6b8d37cddc1b71392bf478ce9c653">SeDeassignSecurity</a></div><div class="ttdeci">NTSTATUS SeDeassignSecurity(__deref_inout PSECURITY_DESCRIPTOR *SecurityDescriptor)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dba/a02692_source.html#l00362">seassign.c:362</a></div></div>
<div class="ttc" id="a02284_html_a6323df0892dd49d75e833591d92e2b06"><div class="ttname"><a href="../../d3/d81/a02284.html#a6323df0892dd49d75e833591d92e2b06">SeInteractiveSid</a></div><div class="ttdeci">PSID SeInteractiveSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00098">seglobal.c:98</a></div></div>
<div class="ttc" id="a02259_html_aed93f572f76288c4e5238b805f0f1c24"><div class="ttname"><a href="../../d3/d3a/a02259.html#aed93f572f76288c4e5238b805f0f1c24">FAILED_ACCESS_ACE_FLAG</a></div><div class="ttdeci">#define FAILED_ACCESS_ACE_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00766">ntseapi.h:766</a></div></div>
<div class="ttc" id="a02259_html_a5befedca477346da731bee5367de1921"><div class="ttname"><a href="../../d3/d3a/a02259.html#a5befedca477346da731bee5367de1921">OWNER_SECURITY_INFORMATION</a></div><div class="ttdeci">#define OWNER_SECURITY_INFORMATION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01773">ntseapi.h:1773</a></div></div>
<div class="ttc" id="a02692_html_a4862002b1da4aae1bec6c8d74a0dc106"><div class="ttname"><a href="../../d2/dba/a02692.html#a4862002b1da4aae1bec6c8d74a0dc106">SeAssignSecurity</a></div><div class="ttdeci">NTSTATUS SeAssignSecurity(__in_opt PSECURITY_DESCRIPTOR ParentDescriptor, __in_opt PSECURITY_DESCRIPTOR ExplicitDescriptor, __out PSECURITY_DESCRIPTOR *NewDescriptor, __in BOOLEAN IsDirectoryObject, __in PSECURITY_SUBJECT_CONTEXT SubjectContext, __in PGENERIC_MAPPING GenericMapping, __in POOL_TYPE PoolType)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dba/a02692_source.html#l00076">seassign.c:76</a></div></div>
<div class="ttc" id="a01737_html"><div class="ttname"><a href="../../df/d2e/a01737.html">_TOKEN</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d0f/a02707_source.html#l00235">tokenp.h:235</a></div></div>
<div class="ttc" id="a02125_html_ac4f0427f782e5bfd15644bc30afc1805"><div class="ttname"><a href="../../d8/db2/a02125.html#ac4f0427f782e5bfd15644bc30afc1805">ExFreePool</a></div><div class="ttdeci">VOID ExFreePool(__in PVOID P)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/db2/a02125_source.html#l05027">pool.c:5027</a></div></div>
<div class="ttc" id="a00533_html"><div class="ttname"><a href="../../db/d44/a00533.html">_GUID</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/dc3/a02190_source.html#l00025">guiddef.h:25</a></div></div>
<div class="ttc" id="a02230_html_ab27e8a5903617bec9d037e4039ac00a7"><div class="ttname"><a href="../../dd/d67/a02230.html#ab27e8a5903617bec9d037e4039ac00a7">PVOID</a></div><div class="ttdeci">void * PVOID</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00245">ntdef.h:245</a></div></div>
<div class="ttc" id="a01625_html"><div class="ttname"><a href="../../d3/d2d/a01625.html">_SID_AND_ATTRIBUTES</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00286">ntseapi.h:286</a></div></div>
<div class="ttc" id="a02184_html_a971c37f796ee1dd6a449795d1b978bf4"><div class="ttname"><a href="../../d5/ddd/a02184.html#a971c37f796ee1dd6a449795d1b978bf4">POOL_TYPE</a></div><div class="ttdeci">enum _POOL_TYPE POOL_TYPE</div></div>
<div class="ttc" id="a00789_html"><div class="ttname"><a href="../../d8/d7d/a00789.html">_KNOWN_ACE</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d4d/a02285_source.html#l00037">seopaque.h:37</a></div></div>
<div class="ttc" id="a02284_html_a47e4281937d40829e19fddd6aa5f9ef5"><div class="ttname"><a href="../../d3/d81/a02284.html#a47e4281937d40829e19fddd6aa5f9ef5">SeBatchSid</a></div><div class="ttdeci">PSID SeBatchSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00097">seglobal.c:97</a></div></div>
<div class="ttc" id="a02289_html_a3f6b8655e1aa9dfc15a9029f0343009e"><div class="ttname"><a href="../../de/d4e/a02289.html#a3f6b8655e1aa9dfc15a9029f0343009e">__in</a></div><div class="ttdeci">#define __in</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00497">specstrings.h:497</a></div></div>
<div class="ttc" id="a02230_html_a6a08ef8cc8945e56aaba56e0c8f194eb"><div class="ttname"><a href="../../dd/d67/a02230.html#a6a08ef8cc8945e56aaba56e0c8f194eb">NTSTATUS</a></div><div class="ttdeci">LONG NTSTATUS</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00534">ntdef.h:534</a></div></div>
<div class="ttc" id="a02284_html_aa41ade34f84ea7003e934c1868ea48df"><div class="ttname"><a href="../../d3/d81/a02284.html#aa41ade34f84ea7003e934c1868ea48df">SeCreatorGroupServerSid</a></div><div class="ttdeci">PSID SeCreatorGroupServerSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00086">seglobal.c:86</a></div></div>
<div class="ttc" id="a02259_html_aa3ccd781d22af696976f185ecefa0f47"><div class="ttname"><a href="../../d3/d3a/a02259.html#aa3ccd781d22af696976f185ecefa0f47">SECURITY_DESCRIPTOR_REVISION</a></div><div class="ttdeci">#define SECURITY_DESCRIPTOR_REVISION</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01045">ntseapi.h:1045</a></div></div>
<div class="ttc" id="a02230_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="../../dd/d67/a02230.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01270">ntdef.h:1270</a></div></div>
<div class="ttc" id="a01587_html_a5766dc6ae7409fedf88a0e7a263cb8ca"><div class="ttname"><a href="../../d6/d91/a01587.html#a5766dc6ae7409fedf88a0e7a263cb8ca">_SECURITY_DESCRIPTOR_RELATIVE::Owner</a></div><div class="ttdeci">ULONG Owner</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01167">ntseapi.h:1167</a></div></div>
<div class="ttc" id="a02286_html_ab480a0f5efb65a4d69b939013a83008b"><div class="ttname"><a href="../../db/d2d/a02286.html#ab480a0f5efb65a4d69b939013a83008b">RtlpInheritAcl</a></div><div class="ttdeci">NTSTATUS RtlpInheritAcl(IN PACL DirectoryAcl, IN PACL ChildAcl, IN ULONG ChildGenericControl, IN BOOLEAN IsDirectoryObject, IN BOOLEAN AutoInherit, IN BOOLEAN DefaultDescriptorForObject, IN PSID OwnerSid, IN PSID GroupSid, IN PSID ServerOwnerSid OPTIONAL, IN PSID ServerGroupSid OPTIONAL, IN PGENERIC_MAPPING GenericMapping, IN BOOLEAN IsSacl, IN GUID **pNewObjectType OPTIONAL, IN ULONG GuidCount, OUT PACL *NewAcl, OUT PBOOLEAN NewAclExplicitlyAssigned, OUT PULONG NewGenericControl)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d32/a02665_source.html#l04746">sertl.c:4746</a></div></div>
<div class="ttc" id="a02289_html_a9a66acb8f87800f41a837406c837cb32"><div class="ttname"><a href="../../de/d4e/a02289.html#a9a66acb8f87800f41a837406c837cb32">__inout</a></div><div class="ttdeci">#define __inout</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00507">specstrings.h:507</a></div></div>
<div class="ttc" id="a01625_html_a65626cb95688165a5d004e32a6e48d48"><div class="ttname"><a href="../../d3/d2d/a01625.html#a65626cb95688165a5d004e32a6e48d48">_SID_AND_ATTRIBUTES::Sid</a></div><div class="ttdeci">PSID Sid</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00287">ntseapi.h:287</a></div></div>
<div class="ttc" id="a02286_html_a68f9703a2b7229281827e1d5bc9a530a"><div class="ttname"><a href="../../db/d2d/a02286.html#a68f9703a2b7229281827e1d5bc9a530a">RtlpOwnerAddrSecurityDescriptor</a></div><div class="ttdeci">#define RtlpOwnerAddrSecurityDescriptor(SD)                                                                </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00059">sertlp.h:59</a></div></div>
<div class="ttc" id="a02244_html_a78212918c5b09e3304c1d3c041ba3a1a"><div class="ttname"><a href="../../d8/d51/a02244.html#a78212918c5b09e3304c1d3c041ba3a1a">OPTIONAL</a></div><div class="ttdeci">IN PLSA_DISPATCH_TABLE IN PLSA_STRING Database OPTIONAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/a02244_source.html#l01130">ntlsa.h:1130</a></div></div>
<div class="ttc" id="a02259_html_a2c99dbbbae1f21757cf867d6ba243e30"><div class="ttname"><a href="../../d3/d3a/a02259.html#a2c99dbbbae1f21757cf867d6ba243e30">SE_DACL_AUTO_INHERITED</a></div><div class="ttdeci">#define SE_DACL_AUTO_INHERITED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01068">ntseapi.h:1068</a></div></div>
<div class="ttc" id="a02259_html_a39e75889cffac1a2830c354f27ea1b43"><div class="ttname"><a href="../../d3/d3a/a02259.html#a39e75889cffac1a2830c354f27ea1b43">SE_SERVER_SECURITY</a></div><div class="ttdeci">#define SE_SERVER_SECURITY</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01064">ntseapi.h:1064</a></div></div>
<div class="ttc" id="a02289_html_abb4c3c1135aab6c47cff22e7c16efb74"><div class="ttname"><a href="../../de/d4e/a02289.html#abb4c3c1135aab6c47cff22e7c16efb74">__out</a></div><div class="ttdeci">#define __out</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d4e/a02289_source.html#l00500">specstrings.h:500</a></div></div>
<div class="ttc" id="a02256_html_a0ae8d4ffaee7142929cc6568f15f7e18"><div class="ttname"><a href="../../de/dc3/a02256.html#a0ae8d4ffaee7142929cc6568f15f7e18">RtlEqualSid</a></div><div class="ttdeci">NTSYSAPI BOOLEAN NTAPI RtlEqualSid(PSID Sid1, PSID Sid2)</div></div>
<div class="ttc" id="a02259_html_a0d38ac1ff4d6cc3b7f3b7bb1243db7c7"><div class="ttname"><a href="../../d3/d3a/a02259.html#a0d38ac1ff4d6cc3b7f3b7bb1243db7c7">SE_OWNER_DEFAULTED</a></div><div class="ttdeci">#define SE_OWNER_DEFAULTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01056">ntseapi.h:1056</a></div></div>
<div class="ttc" id="a02230_html_aec78e7a9e90a406a56f859ee456e8eae"><div class="ttname"><a href="../../dd/d67/a02230.html#aec78e7a9e90a406a56f859ee456e8eae">OUT</a></div><div class="ttdeci">#define OUT</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00035">ntdef.h:35</a></div></div>
<div class="ttc" id="a02259_html_a835b909110f55ce5de0cb58fbf9bdf94"><div class="ttname"><a href="../../d3/d3a/a02259.html#a835b909110f55ce5de0cb58fbf9bdf94">OBJECT_INHERIT_ACE</a></div><div class="ttdeci">#define OBJECT_INHERIT_ACE</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l00740">ntseapi.h:740</a></div></div>
<div class="ttc" id="a02260_html_ae56fdb340b23940f7a64ed2e37c1774a"><div class="ttname"><a href="../../dc/d18/a02260.html#ae56fdb340b23940f7a64ed2e37c1774a">STATUS_SUCCESS</a></div><div class="ttdeci">#define STATUS_SUCCESS</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d18/a02260_source.html#l00049">ntstatus.h:49</a></div></div>
<div class="ttc" id="a02249_html_a52fc7f452e668852583761414c892784"><div class="ttname"><a href="../../dd/dc3/a02249.html#a52fc7f452e668852583761414c892784">PAGED_CODE</a></div><div class="ttdeci">#define PAGED_CODE()</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/dc3/a02249_source.html#l00437">ntosdef.h:437</a></div></div>
<div class="ttc" id="a02244_html_ae2e004c27e6212fe6bd33cc5c6552347"><div class="ttname"><a href="../../d8/d51/a02244.html#ae2e004c27e6212fe6bd33cc5c6552347">AccountName</a></div><div class="ttdeci">IN SECURITY_LOGON_TYPE IN PVOID IN PVOID IN ULONG OUT PVOID OUT PULONG OUT PLUID OUT PNTSTATUS OUT PLSA_TOKEN_INFORMATION_TYPE OUT PVOID OUT PLSA_UNICODE_STRING * AccountName</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d51/a02244_source.html#l01139">ntlsa.h:1139</a></div></div>
<div class="ttc" id="a02259_html_a8d0e3871ec8a12b6bcda7c0858ba64be"><div class="ttname"><a href="../../d3/d3a/a02259.html#a8d0e3871ec8a12b6bcda7c0858ba64be">SE_DACL_UNTRUSTED</a></div><div class="ttdeci">#define SE_DACL_UNTRUSTED</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d3a/a02259_source.html#l01063">ntseapi.h:1063</a></div></div>
<div class="ttc" id="a02286_html_a16277294a616a48692ab4f2913fa1834"><div class="ttname"><a href="../../db/d2d/a02286.html#a16277294a616a48692ab4f2913fa1834">RtlpSetControlBits</a></div><div class="ttdeci">#define RtlpSetControlBits(SD, Bits)                                                                                      </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00137">sertlp.h:137</a></div></div>
<div class="ttc" id="a02284_html_a7e011c93ee1075507e9655c1d6651df0"><div class="ttname"><a href="../../d3/d81/a02284.html#a7e011c93ee1075507e9655c1d6651df0">SeCreatorGroupSid</a></div><div class="ttdeci">PSID SeCreatorGroupSid</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/da6/a02696_source.html#l00085">seglobal.c:85</a></div></div>
<div class="ttc" id="a02230_html_af632da489ebc3708ec3ab6791ee53fa4"><div class="ttname"><a href="../../dd/d67/a02230.html#af632da489ebc3708ec3ab6791ee53fa4">ULONG</a></div><div class="ttdeci">unsigned long ULONG</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l00392">ntdef.h:392</a></div></div>
<div class="ttc" id="a02286_html_a52b78c0ccc1a141bb2f0912ae90fb1be"><div class="ttname"><a href="../../db/d2d/a02286.html#a52b78c0ccc1a141bb2f0912ae90fb1be">RtlpDaclAddrSecurityDescriptor</a></div><div class="ttdeci">#define RtlpDaclAddrSecurityDescriptor(SD)                                                                  </div><div class="ttdef"><b>Definition:</b> <a href="../../db/d2d/a02286_source.html#l00086">sertlp.h:86</a></div></div>
<div class="ttc" id="a02230_html_ab8caf1706fee9e06b2937fec2fb3d6ed"><div class="ttname"><a href="../../dd/d67/a02230.html#ab8caf1706fee9e06b2937fec2fb3d6ed">UNREFERENCED_PARAMETER</a></div><div class="ttdeci">#define UNREFERENCED_PARAMETER(P)                </div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d67/a02230_source.html#l01917">ntdef.h:1917</a></div></div>
<div class="ttc" id="a02259_html_ad30a32f32e06e7bb16b53e0a443eb289"><div class="ttname"><a href="../../d3/d3a/a02259.html#ad30a32f32e06e7bb16b53e0a443eb289">PISID</a></div><div class="ttdeci">struct _SID * PISID</div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_f22a2235bfed9e7f28226e9ee4e6031c.html">Windows Research Kernel</a></li><li class="navelem"><a class="el" href="../../dir_f77fe4490106970a12ada801b7f01368.html">se</a></li><li class="navelem"><a class="el" href="../../d2/dba/a02692.html">seassign.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
